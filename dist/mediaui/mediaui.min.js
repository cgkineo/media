(function(root,factory){if(typeof define==='function'&&define.amd){define(function(){return factory(root, root.jQuery);});}else{var module = factory(root, root.jQuery);for(var k in module){root[k]=module[k];}}}(typeof self!=='undefined'?self:this,function(window,$){var exports = {}; var parseUnit=function(a,b,c){a=String(a||0)+String(b||"");var d=a.match(/[^0-9\.]+/g);b=b||c||"px";d&&(b=d[0]);return{value:parseFloat(a)||0,unit:b}},makeUnit=function(a,b,c){b=b||c||"px";switch(b){case "px":a=Math.round(a,0)}return a+b};var toggleClass=function(a,b,c){switch(typeof b){case "string":b=b.split(" ")}c=void 0===c?!0:c;for(var d=a.classList,e=0,f=b.length;e<f;e++){for(var g=b[e],l=!1,h=0,k=d.length;h<k;h++)d[h]===g&&(l=!0);!l&&c?d.add(g):l&&!c&&d.remove(g)}0===a.classList.length&&removeAttribute(a,"class")},removeAttribute=function(a,b){if(a.removeAttribute)return a.removeAttribute(b);if(a.attributes.removeNamedItem&&a.attributes.getNamedItem(b))return a.attributes.removeNamedItem(b);a.setAttribute(b,"")},removeElement=
function(a){if(a.remove)return a.remove();a.parentNode&&a.parentNode.removeChild(a)},replaceWith=function(a,b){if(a.replaceWith)return a.replaceWith(b);for(var c=a.parentNode,d=0,e=c.childNodes.length;d<e;d++)if(c.childNodes[d]===a){c.insertBefore(b,a);removeElement(a);break}},prependElement=function(a,b){if(!a.childNodes.length)return a.appendChild(b);a.insertBefore(b,a.childNodes[0])},createEvent=function(a,b){b=defaults(b,{bubbles:!1,cancelable:!0});if(!createEvent._ie11)try{var c=new Event(a,
b);return c}catch(d){createEvent._ie11=!0}if(createEvent._ie11)return c=document.createEvent("Event"),c.initEvent(a,b.bubbles,b.cancelable),c};var delay=function(a,b){setTimeout(a,b)},debounce=function(a,b){var c=null;return function(){var d=arguments;clearTimeout(c);c=setTimeout(function(){a.apply(this,d)}.bind(this),b||0)}},getUrl=function(a,b,c){var d=new XMLHttpRequest;d.addEventListener("load",function(a){b.call(c,a.target.responseText)});d.open("GET",a);d.send()},postUrl=function(a,b,c,d){var e=new XMLHttpRequest;e.addEventListener("load",function(a){c.call(d,a.target.responseText)});e.open("POST",a);e.send(b)};var toArray=function(a,b){return a?Array.prototype.slice.call(a,b||0):[]},isArray=function(a){return"[object Array]"==Object.prototype.toString.call(a)},find=function(a,b){for(var c=0,d=a.length;c<d;c++)if(b)return a;return null};var clamp=function(a,b,c){return b<a?a:b>c?c:b},isNumber=function(a){return"[object Number]"==Object.prototype.toString.call(a)};var isObject=function(a){return"[object Object]"==Object.prototype.toString.call(a)},ObjectValues=function(a){var b=[],c;for(c in a)b.push(a[c]);return b},extendNotEnumerable=function(a,b){for(var c=1,d=arguments.length;c<d;c++){var e=arguments[c];if(e){var f=Object.keys(e);c=0;for(d=f.length;c<d;c++){var g=f[c];Object.getOwnPropertyDescriptor(e,g).configurable&&Object.defineProperty(a,g,{configurable:!0,value:e[g],enumerable:!1,writable:!0})}}}return a},extend=function(a,b){a=a||{};for(var c=1,d=
arguments.length;c<d;c++){var e=arguments[c],f;for(f in e)a[f]=e[f]}return a},deepDefaults=function(a,b){a=a||{};for(var c=1,d=arguments.length;c<d;c++){var e=arguments[c],f;for(f in e)a.hasOwnProperty(f)||(a[f]=e[f]),isObject(a[f])&&(a[f]=deepDefaults(a[f],e[f]))}return a},defaults=function(a,b){a=a||{};for(var c=1,d=arguments.length;c<d;c++){var e=arguments[c],f;for(f in e)a.hasOwnProperty(f)||(a[f]=e[f])}return a},get=function(a,b){b=b.split(/[\/\.:]/g);do a=a[b.shift()];while("object"===typeof a&&
null!==a&&b.length);return a},set=function(a,b,c){b=b.split(/[\/\.:]/g);do{if(1===b.length)break;var d=b.shift();a[d]||(a[d]={});a=a[d]}while("object"===typeof a&&null!==a);d=b.shift();void 0===c?delete a[d]:a[d]=c};var indexOfRegex=function(a,b,c){a=(c=c||0)?a.substring(c):a;return(b=a.match(b))?a.indexOf(b[0])+c:-1},lastIndexOfRegex=function(a,b,c){a=(c=c||0)?a.substring(0,c):a;return(b=a.match(b))?a.lastIndexOf(b[b.length-1]):-1},includes=function(a,b,c){"number"!==typeof c&&(c=0);return"string"===typeof a&&c+b.length>a.length?!1:-1!==a.indexOf(b,c)},replace=function(a,b,c){c=c||{clean:!0};replace.cache=replace.cache||{};for(var d in b){var e="\\$\\{"+d+"\\}";e=replace.cache[e]=replace.cache[e]||new RegExp("\\$\\{"+
d+"\\}","gi");a=a.replace(e,b[d])}c.clean&&(a=a.replace(/\$\{[^\}]+\}/g,""));return a};var properties=function(a,b){var c=function(a,b){return function(){return this["_"+a]=this["_"+a]||b.bind(this)}},d=!!b;b=b||a;for(var e={},f=Object.getOwnPropertyNames(b),g=0,l=f.length;g<l;g++){var h=f[g],k=h.indexOf("$");if(-1!==k||d){if(-1===k){var m="";k=h}else m=h.slice(k),k=h.slice(0,k);if(k){var n=m.split("$"),q=includes(n,"bind");m=includes(n,"get");var p=includes(n,"set"),r=includes(n,"value"),v=includes(n,"enum"),u=includes(n,"write");n=includes(n,"config");var t=0;t+=m?1:0;t+=p?1:0;t+=
r?1:0;if(1<t)throw"Cannot have two types in one definition.";t+=v?1:0;t+=u?1:0;t+=n?1:0;q?(m=!0,u=!1,q=c(k,b[h])):q=b[h];r=e[k]=e[k]||{value:q};m&&(r.get=q);p&&(r.set=q);v&&(r.enumerable=!0);u&&(r.writable=!0);n&&(r.configurable=!0);r.value&&(r.get||r.set)&&delete r.value;delete b[h];delete a[k]}}}if(!Object.keys(e).length)return a;Object.defineProperties(a,e);return a};var EventsInitialize=function(a){a.events&&a.trigger||(a.events||Object.defineProperty(a,"events",{value:new EventsRegistry,enumerable:!1,writable:!0}),a.trigger||Object.defineProperty(a,"trigger",{value:Events.trigger,enumerable:!1,writable:!0}))},EventsArgumentsNotation=function(a,b,c,d,e){if(a instanceof Object){c=c||e;for(var f in a)for(var g=f.split(" "),l=0,h=g.length;l<h;l++){var k=g[l];d.call(e,k,a[f],c)}}else if("string"===typeof a)for(c=c||e,g=a.split(" "),l=0,h=g.length;l<h;l++)k=g[l],
d.call(e,k,b,c);else if(void 0===a&&void 0===b&&void 0===c)return d.call(e,null,null,null)},EventsRegistry=function(){};EventsRegistry.prototype=[];var EventRegister=function(a){if(a.name){if(!a.callback)throw"Cannot find callback";EventsInitialize(a.from);EventsInitialize(a.to);this.from=a.from;this.to=a.to;this.context=a.context;this.name=a.name;this.callback=a.callback;this.once=a.once;this.from.events.push(this);this.from!==this.to&&this.to.events.push(this)}};
EventRegister.prototype.destroy=function(){this.from.events=this.from.events.filter(function(a){return a!==this}.bind(this));this.from!==this.to&&(this.to.events=this.to.events.filter(function(a){return a!==this}.bind(this)))};
var Events={events:null,listenTo:function(a,b,c){EventsArgumentsNotation(b,c,a,function(a,b,c){new EventRegister({from:c,to:this,context:this,name:a,callback:b,once:!1})},this)},listenToOnce:function(a,b,c){EventsArgumentsNotation(b,c,a,function(a,b,c){new EventRegister({from:c,to:this,context:this,name:a,callback:b,once:!0})},this)},stopListening:function(a,b,c){EventsArgumentsNotation(b,c,a,function(a,b,c){if(this.events)for(c=this.events.length-1;-1<c;c--){var d=this.events[c];d.to.events!==this.events||
null!==a&&d.name!==a||null!==b&&d.callback!==b||d.destroy()}},this)},on:function(a,b,c){EventsArgumentsNotation(a,b,c,function(a,b,c){new EventRegister({from:this,to:this,context:c,name:a,callback:b,once:!1})},this)},once:function(a,b,c){EventsArgumentsNotation(a,b,c,function(a,b,c){new EventRegister({from:this,to:this,context:c,name:a,callback:b,once:!0})},this)},off:function(a,b,c){EventsArgumentsNotation(a,b,c,function(a,b,c){if(this.events)for(c=this.events.length-1;-1<c;c--){var d=this.events[c];
d.from.events!==this.events||null!==a&&d.name!==a||null!==b&&d.callback!==b||d.destroy()}},this)},trigger:function(a){EventsInitialize(this);var b=[];if(this.events){for(var c=0,d=this.events.length;c<d;c++){var e=this.events[c];e.from.events!==this.events||"*"!==e.name&&e.name!==a||b.push(e)}b.reverse();for(c=b.length-1;-1<c;c--)e=b[c],"*"===e.name?e.callback.apply(e.context,arguments):e.callback.apply(e.context,toArray(arguments,1)),e.once&&e.destroy()}},destroy:function(){this.stopListening()}};var ClassExtend=function(a,b,c){var d=this;var e=a&&a.hasOwnProperty("constructor")?a.constructor:function(){return d.apply(this,arguments)};Object.defineProperty(e,"classOptions",{value:defaults(c,d.classOptions,{extendFunction:!0,inheritClassEnumerables:!1,classEvents:!1,classProperties:!0,instanceEvents:!1,instanceProperties:!0}),enumerable:!1,writable:!0});e.prototype=Object.create(d.prototype);e.classOptions.extendFunction&&extendNotEnumerable(e,{extend:ClassExtend});e.classOptions.classEvents&&
extendNotEnumerable(e,Events);e.classOptions.inheritClassEnumerables&&extend(e,d);extend(e,b);e.classOptions.instanceEvents&&void 0===e.prototype.events&&extendNotEnumerable(e.prototype,Events);extend(e.prototype,a);e.classOptions.instanceProperties&&(Object.defineProperty(e.prototype,"defineProperties",{value:function(a){return properties(this,a)},enumerable:!1,writable:!1,configurable:!1}),properties(e.prototype));e.classOptions.classProperties&&(Object.defineProperty(e,"defineProperties",{value:function(a){return properties(this,
a)},enumerable:!1,writable:!1,configurable:!1}),properties(e));extendNotEnumerable(e.prototype,{constructor:e});return e},ClassParent=function(a,b){},ListParent=function(a,b){};ListParent.prototype=[];var Class=ClassExtend.call(ClassParent,{constructor:function(){}},{},{classEvents:!1,instanceEvents:!1}),List=ClassExtend.call(ListParent,{constructor:function(){}},{},{classEvents:!1,instanceEvents:!1});
Array.prototype.find||(List.prototype.find=function(a){for(var b=0,c=this.length;b<c;b++)if(a(this[b],b))return this[b]});var Elements=List.extend({subject:null,constructor:function(a,b){this.subject=b||document;this.add(a,this.subject);this.selector=a},filterByAttribute:function(a,b){var c=this.filter(function(c){if(c=c.getAttribute(a))if(c=c.split(" "),includes(c,b))return!0});return new Elements(c)},filterByTypes:function(a){var b=a.split(",").map(function(a){return a.trim()});a=this.filter(function(a){a=a.tagName.toLowerCase();if(includes(b,a))return!0});return new Elements(a)},query:function(a){var b=new Elements;
this.forEach(function(c){b.push.apply(b,c.querySelectorAll(a))});return b},isHidden:function(){return!!this.stack().find(function(a){a=window.getComputedStyle(a);return"hidden"==a.visibility||"none"==a.display||0==a.opacity})},stack:function(a){var b=this.parents();b.unshift(this[0]);a&&(b=b.filter(function(b){return b.matches(a)}));return b},parents:function(a){var b=this[0],c=new Elements;do(b=b.parentNode)&&c.add(b);while(b);a&&(c=c.filter(function(b){return b.matches(a)}));return c},value:function(){return this[0].value},
add:function(a,b){this.selector="";b=b||document;if(a instanceof HTMLElement)return this.push(a),this;if(a instanceof Array||a instanceof NodeList){b=0;for(var c=a.length;b<c;b++)this.add(a[b]);return this}if("string"===typeof a)for(a=b.querySelectorAll(a),b=0,c=a.length;b<c;b++)this.push(a[b]);return this},clone:function(a){for(var b=[],c=0,d=this.length;c<d;c++)b.push(this[c].cloneNode(a));return new Elements(b,this.subject)},on:function(a,b,c){c=c||{};c.passive=!1!==c.passive?!0:c.passive;if(a instanceof
Object){for(var d in a)this.on(d,a[d],b);return this}this.forEach(function(d){d.addEventListener(a,b,c)});return this},off:function(a,b){if(a instanceof Object){for(var c in a)this.off(c,a[c]);return this}this.forEach(function(c){c.removeEventListener(a,b)});return this},removeAttributes:function(a){if(a)return this.removeAttribute(a);a=this.attrs();return this.removeAttribute(a)},removeAttribute:function(a){if(a instanceof Object){for(var b in a)this.removeAttribute(b);return this}this.forEach(function(b){removeAttribute(b,
a)});return this},attrs:function(a){if(a)return this.attr(a);a={};for(var b=0,c=this[0].attributes.length;b<c;b++)a[this[0].attributes[b].name]=this[0].attributes[b].value;return a},attr:function(a,b){if(a instanceof Object){for(var c in a)this.attr(c,a[c]);return this}this.forEach(function(c){c.setAttribute(a,b)});return this},toggleClass:function(a,b){this.forEach(function(c){toggleClass(c,a,b)});return this},html:function(a){if(void 0===a)return this[0]&&this[0].innerHTML;this.forEach(function(b){b.innerHTML=
a})}}),elements=function(a,b){return new Elements(a,b)};extend(elements,Elements);var Rafer=Class.extend({deferred:null,requests:null,isWaiting:!1,mode:"ram",ramLimit:50,currentDeferredLength:0,currentRequestsLength:0,constructor:function(){this.defineProperties({deferred$write:Array(100),requests$write:Array(100),currentDeferredLength$write:0,currentRequestsLength$write:0,isWaiting$write:!1})},resizeDeferred$write:function(){this.deferred.length*=2},resizeRequests$write:function(){this.requests.length*=2},set:function(a,b,c){this.isWaiting||this.request(this.dummy);this.currentDeferredLength===
this.deferred.length-1&&this.resizeDeferred();this.deferred[this.currentDeferredLength]={subject:a,name:b,value:c,type:"set"};this.currentDeferredLength++},get:function(a,b){for(var c=0,d=this.currentDeferredLength;c<d;c++){var e=this.deferred[c];if(e.subject===a&&e.name===b)return e.value}return a[b]},call:function(a,b,c){this.isWaiting||this.request(this.dummy);this.currentDeferredLength===this.deferred.length-1&&this.resizeDeferred();var d={order:0,subject:a,name:b,value:toArray(arguments,2),type:"call"};
this.deferred[this.currentDeferredLength]=d;this.currentDeferredLength++},callLast:function(a,b,c){this.isWaiting||this.request(this.dummy);this.currentDeferredLength===this.deferred.length-1&&this.resizeDeferred();var d={order:1,subject:a,name:b,value:toArray(arguments,2),type:"call"};this.deferred[this.currentDeferredLength]=d;this.currentDeferredLength++},dummy$write:function(){},flush$write:function(){var a=0;do{for(var b=[],c=this.currentDeferredLength,d=0,e=c;d<e;d++)b.push(this.deferred[d]),
this.deferred[d]=null;b.sort(function(a,b){return b.order-a.order});d=this.currentDeferredLength=0;for(e=c;d<e;d++){c=b[d];try{switch(c.type){case "set":c.subject[c.name]=c.value;break;case "call":c.name||"function"!==typeof c.subject?c.subject||"function"!==typeof c.name?c.subject[c.name].apply(c.subject,c.value):c.name.apply(c.subject,c.value):c.subject.apply(c.name,c.value)}}catch(f){debugger}}this.currentDeferredLength&&a++}while("ram"===this.mode&&0!==this.currentDeferredLength&&a<this.ramLimit);
a===this.ramLimit&&(this.mode="wait",console.log("Deferred queue modified by queue, switching to wait mode."))},request:function(a,b){!a||a._raferQueuePosition&&!b||(this.currentRequestsLength===this.requests.length&&this.resizeRequests(),this.requests[this.currentRequestsLength]=a,a._raferQueuePosition=this.currentRequestsLength+1,this.currentRequestsLength++);this.currentRequestsLength&&!this.isWaiting&&(this.isWaiting=!0,window.requestAnimationFrame(this.frame))},frame$write$bind:function(){for(var a=
[],b=this.currentRequestsLength,c=0,d=b;c<d;c++)a.push(this.requests[c]),this.requests[c]=null;c=this.currentRequestsLength=0;for(d=b;c<d;c++)a[c]._raferQueuePosition=null,a[c](),a[c]=null;this.isWaiting=!1;this.flush();this.request()}}),rafer=new Rafer;var Media=Class.extend({el:null,options:null,constructor:function Media(a,b){if(a[Media.propName])return a;this.defineProperties({proxyEvent$write:this.proxyEvent.bind(this)});this.el=a;this.el[Media.propName]=this;this.options=b||{};this.options instanceof Media.DefaultOptions||(this.options=new Media.DefaultOptions(this.options));this.options.add({media:this,id:this.el.id});this.initialize()},initialize:function(){Media.players.push(this);Media.trigger("create",this);this.trigger("create");this.attachEvents();
delay(function(){Media.trigger("created",this);this.trigger("created");this.checkPlaying()}.bind(this),1)},checkPlaying$write:function(){this.el.paused||this.dispatchEvent("play")},attachEvents$write:function(){for(var a=0,b=Media.DOMEvents.length;a<b;a++)this.el.addEventListener(Media.DOMEvents[a],this.proxyEvent)},dispatchEvent:function(a,b){"timeupdate"===a&&(b=defaults(b,{fast:!0,medium:!0,slow:!0}));a=createEvent(a,b);a.fake=!0;extend(a,b);this.el.dispatchEvent(a)},proxyEvent$write:function(a){if(a.fake||
"timeupdate"!==a.type)(a.fake||"resize"!==a.type)&&this.trigger(a.type,a),Media.trigger(a.type,this,a)},destroy:function(){Media.trigger("destroy",this);this.trigger("destroy");for(var a=Media.players.length-1;-1<a;a--)Media.players[a]===this&&Media.players.splice(a,1);this.detachEvents();this.options=this.selector=null;delay(function(){delete this.el[Media.propName];this.el=null;Media.trigger("destroyed",this);this.trigger("destroyed")}.bind(this),1)},detachEvents$write:function(){for(var a=0,b=
Media.DOMEvents.length;a<b;a++)this.el.removeEventListener(Media.DOMEvents[a],this.proxyEvent)}},{supportedTags$enum$write:"video, audio, canvas, img",propName$enum$write:"player",Class$write:Class.extend({constructor:function(){}},{List:List.extend({constructor:function(){}},null,{instanceEvents:!0})},{instanceEvents:!0})},{classEvents:!0,instanceEvents:!0});"undefined"===typeof exports?window.Media=Media:exports.Media=Media;Media.DefaultOptions=Class.extend({constructor:function(a){this.add(a)},add$write:function(a){extend(this,a)},get$write:function(a){return this[a]},toJSON$write:function(){var a={},b;for(b in this)a[b]=this[b];return a}},{add$write$enum:function(a){var b=function(a,b){Object.defineProperty(this.prototype,a,{enumerable:!0,get:function(){return"function"===typeof this["_"+a]?this["_"+a]():this["_"+a]},set:function(b){this.hasOwnProperty("_"+a)||Object.defineProperty(this,"_"+a,{enumerable:!1,writable:!0,
value:null});this["_"+a]=b}});this.prototype[a]=b}.bind(this),c;for(c in a)b(c,a[c])},get$write$enum:function(a){return this.prototype[a]},toJSON$write$enum:function(){var a={},b;for(b in this.prototype)a[b]=this.prototype[b];return a}},{inheritClassEnumerables:!0});Media.DefaultOptions.add({id:"",media:null});Media.Class.DOMEvents=Media.Class.List.extend({constructor:function(){},add:function(a){return a instanceof Array?this.push.apply(this,a):this.push(a)}});Media.defineProperties({DOMEvents$write:new Media.Class.DOMEvents});Media.DOMEvents.add("abort canplay canplaythrough durationchange emptied ended error loadeddata loadedmetadata loadstart pause play playing process ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "));Media.Class.Device=Media.Class.extend({isUsingTouch:!1,lastTouch:null,constructor:function(){this.checkTouchDevice()},isIOS$get$enum:function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&!window.MSStream},wasTouchedRecently$get$enum:function(){return 600>Date.now()-this.lastTouch},checkTouchDevice$write:function(){var a=function(){this.lastTouch=Date.now();this.isUsingTouch=!0}.bind(this);window.addEventListener("touchstart",a,{capture:!0,passive:!0});window.addEventListener("touchend",
a,{capture:!0,passive:!0})}});Media.defineProperties({device$enum:new Media.Class.Device});var MediaUIComponent=Class.extend({constructor:function(a){this.listenTo(a.media,{destroyed:function(){this.destroy()}})}},null,{instanceEvents:!0});var MediaUIController=MediaUIComponent.extend({constructor:function(){MediaUIComponent.apply(this,arguments)}});var MediaUIInput=MediaUIComponent.extend({constructor:function(){MediaUIComponent.apply(this,arguments)}});var MediaUIOutput=MediaUIComponent.extend({constructor:function(){MediaUIComponent.apply(this,arguments)}});var MediaUIList=List.extend({constructor:function(){},add:function(a){this.find(function(b){return a===b})||this.push(a)},remove:function(a){for(var b=-1,c=0,d=this.length;c<d;c++)if(a===this[c]){b=c;break}-1!==b&&this.splice(b,1)}});(function(){function a(a){27===a.keyCode&&n&&m&&document.exitFullscreen()}if(!window.fullscreenPolyfill){var b=!1,c=function(a){a=a||{};for(var b=1,d=arguments.length;b<d;b++){var e=arguments[b],f;for(f in e)a.hasOwnProperty(f)||(a[f]=e[f]),"[object Object]"==Object.prototype.toString.call(a[f])&&(a[f]=c(a[f],e[f]))}return a},d=function(a){if(!d._ie11)try{var b=new Event(a);return b}catch(u){d._ie11=!0}if(d._ie11)return b=document.createEvent("Event"),b.initEvent(a,!0,!0),b},e={fullscreenElement:null,
exitFullscreen:null,requestFullscreen:null,fullscreenEnabled:null,onfullscreenchange:null,onfullscreenerror:null},f={fullscreenElement:["webkitFullscreenElement","mozFullScreenElement","msFullscreenElement"],exitFullscreen:["webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"],requestFullscreen:["webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen"],fullscreenEnabled:["webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled"],onfullscreenchange:["onwebkitfullscreenchange",
"onmozfullscreenchange","onmsfullscreenchange"],onfullscreenerror:["onwebkitfullscreenerror","onmozfullscreenerror","onmsfullscreenerror"],fullscreenchange:["webkitfullscreenchange","mozfullscreenchange","msfullscreenchange"],fullscreenerror:["webkitfullscreenerror","mozfullscreenerror","msfullscreenerror"]},g=!1,l=!0,h=!0,k=function(a,b,c){if(void 0!==a[b])e[b]=b;else{c=0;for(var d=f[b].length;c<d;c++){var g=f[b][c];if(void 0!==a[g]){l=!1;e[b]=g;return}}h=l=!1;e[b]=null}},m=!1,n=null,q=!1,p={fullscreenElement:!1,
fullscreenEnabled:!1,exitFullscreen:!1,requestFullscreen:!1,onfullscreenchange:!1,onfullscreenerror:!1};document.addEventListener("fullscreenchange",function(a){document.fullscreenElement&&q&&(q=!1);b&&console.log("fullscreenchange",document.fullscreenElement,a)});document.addEventListener("fullscreenerror",function(a){q=!1;b&&console.log("fullscreenerror",document.fullscreenElement,a);m=!0;document.exitFullscreen&&document.exitFullscreen()});k(document,"fullscreenElement");k(document,"exitFullscreen");
k(Element.prototype,"requestFullscreen");k(document,"fullscreenEnabled");k(document,"onfullscreenchange");k(document,"onfullscreenerror");(function(){if(!g){g=!0;for(var a=function(a){a=c(d("fullscreenchange"),a);document.dispatchEvent(a)},b=function(a){a=c(d("fullscreenerror"),a);document.dispatchEvent(a)},e=0,h=f.onfullscreenchange.length;e<h;e++)void 0!==document[f.onfullscreenchange[e]]&&(document[f.onfullscreenchange[e]]=a);e=0;for(h=f.onfullscreenerror.length;e<h;e++)void 0!==document[f.onfullscreenerror[e]]&&
(document[f.onfullscreenerror[e]]=b)}})();(function(){p.fullscreenElement||(p.fullscreenElement=!0,Object.defineProperty(document,"fullscreenElement",{get:function(){if(m)return b&&console.log("get fullscreenElement",n),n;b&&console.log("get fullscreenElement",document[e.fullscreenElement]);return document[e.fullscreenElement]}}))})();(function(){p.fullscreenEnabled||(p.fullscreenEnabled=!0,Object.defineProperty(document,"fullscreenEnabled",{get:function(){if(m)return b&&console.log("get fullscreenEnabled",
!0),!0;b&&console.log("get fullscreenEnabled",document[e.fullscreenEnabled]);return document[e.fullscreenEnabled]}}))})();(function(){p.exitFullscreen||(p.exitFullscreen=!0,document.exitFullscreen=function(){b&&console.log("exitFullscreen");if(m)n=null,document.dispatchEvent(d("fullscreenchange"));else return document[e.exitFullscreen].apply(this,arguments)})})();(function(){p.requestFullscreen||(p.requestFullscreen=!0,Element.prototype.requestFullscreen=function(){q=!0;b&&console.log("requestFullscreen",
this);if(m)n=this,document.dispatchEvent(d("fullscreenchange"));else return this[e.requestFullscreen].apply(this,arguments)})})();(function(){p.onfullscreenchange||(p.onfullscreenchange=!0,Object.defineProperty(document,"onfullscreenchange",{get:function(){b&&console.log("get onfullscreenchange",document[e.onfullscreenchange]);return document[e.onfullscreenchange]},set:function(a){b&&console.log("set onfullscreenchange",document[e.onfullscreenchange]);document[e.onfullscreenchange]=a}}))})();(function(){p.onfullscreenerror||
(p.onfullscreenerror=!0,Object.defineProperty(document,"onfullscreenerror",{get:function(){b&&console.log("get onfullscreenerror",document[e.onfullscreenerror]);return document[e.onfullscreenerror]},set:function(a){b&&console.log("set onfullscreenerror",document[e.onfullscreenerror]);document[e.onfullscreenerror]=a}}))})();window.removeEventListener("keyup",a);window.addEventListener("keyup",a);m=!document.fullscreenEnabled;window.fullscreenPolyfill={};Object.defineProperties(window.fullscreenPolyfill,
{useFullWindow:{get:function(){return m},set:function(a){m=a},enumerable:!0},api:{get:function(){return e},enumerable:!0},applied:{get:function(){return p},enumerable:!0},debug:{get:function(){return b},set:function(a){b=a}}});h?l?console.log("Fullscreen API (from perfect API)."):console.log("Fullscreen API (from partially implemented API)."):console.log("Fullscreen API (from broken API).")}})();var MediaUI=Class.extend({media$write:null,options$write:null,source$write:null,$source$write:null,el$write:null,$el$write:null,inputs:null,outputs:null,constructor:function MediaUI(a,b){if(!b.uienabled)return this.destroy();this.media=a;this.media.ui=this.media.ui||new MediaUIList;this.media.ui.add(this);this.options=b||{};this.options instanceof Media.DefaultOptions||(this.options=new Media.DefaultOptions(b));this.options.add({ui:this});this.source=a.el;this.$source=elements(a.el);this.inputs={};
this.outputs={};this.listenTo(a,{destroyed:this.onDestroyed});MediaUI.layouts.load(this.options,function(a){this.options.uilayout=a;this.ensureElement();this.processOptions();this.startControllers();this.startOutputs();this.startInputs();this.trigger("ready")}.bind(this))},$:function(a){return this.$el.query(a)},$all:function(){var a=this.$("*");a.unshift(this.el);return a},ensureElement$write:function(){this.el=this.options.el||this.getRenderedTemplate();this.$el=elements(this.el)},getRenderedTemplate$write:function(){var a=
this.options.uilayout.template;if(a=replace(a,this.options)){var b=document.createElement("div");b.innerHTML=a;return b.children[0]}},processOptions$write:function(){this.originalAttributes=this.$source.attrs();if(this.options.uireplace){var a=this.$("*").filterByAttribute(this.options.outputattribute,"mediaseat")[0];replaceWith(this.source,this.el);prependElement(a,this.source)}this.options.videoplaysinline&&"VIDEO"===this.source.tagName&&this.source.setAttribute("playsinline",!0);this.source.setAttribute("tabindex",
"-1");this.source.setAttribute("aria-hidden","true")},startControllers$write:function(){for(var a in MediaUI.Controller){var b=MediaUI.Controller[a];b.prototype instanceof MediaUI.Controller&&(this[a.toLowerCase()]=new b(this))}},startInputs$write:function(){for(var a in MediaUI.Input){var b=MediaUI.Input[a];b.prototype instanceof MediaUI.Input&&(this.inputs[a.toLowerCase()]=new b(this))}},startOutputs$write:function(){for(var a in MediaUI.Output){var b=MediaUI.Output[a];b.prototype instanceof MediaUI.Output&&
(this.outputs[a.toLowerCase()]=new b(this))}},unprocessOptions$write:function(){this.options.uireplace&&replaceWith(this.el,this.source);this.$source.attrs(this.originalAttributes)},onDestroyed:function(){this.unprocessOptions();this.media.ui.remove(this);this.outputs=this.inputs=this.$el=this.el=this.$source=this.source=this.options=this.media=null;this.destroy()}},{Input$write:MediaUIInput,Output$write:MediaUIOutput,Controller$write:MediaUIController},{instanceEvents:!0});
Media.DefaultOptions.add({videoplaysinline:!1,classprefix:"mediaui--",outputattribute:"data-media-output",inputattribute:"data-media-input",ui:null,uienable:!1,uireplace:!1});"undefined"===typeof exports?window.MediaUI=MediaUI:exports.MediaUI=MediaUI;$&&$.fn&&(Media=("undefined"===typeof exports?window:exports).Media,MediaUI=("undefined"===typeof exports?window:exports).MediaUI,Media.JQueryDefaultOptions=Media.DefaultOptions.extend({constructor:function(){Media.DefaultOptions.prototype.constructor.apply(this,arguments)}}),Media.JQueryDefaultOptions.add({uienabled:!0,uireplace:!0}),$.fn.medias=function(a){var b=this.find(Media.supportedTags);b=b.add(this.filter(Media.supportedTags));switch(a){case "destroy":return b.each(function(a,b){b[Media.propName]instanceof
Media&&b[Media.propName].destroy()}),b}b.each(function(b,d){d[Media._prop]||(a=new Media.JQueryDefaultOptions(a),b=new Media(d,a),MediaUI&&new MediaUI(b,a))});return b},$.fn.play=function(){var a=this.find(Media.supportedTags);a=a.add(Media.supportedTags);a.each(function(a,c){c.play&&c.play()})},$.fn.pause=function(){var a=this.find(Media.supportedTags);a=a.add(this.filter(Media.supportedTags));a.each(function(a,c){c.pause&&c.pause()})});Media.Class.Dimensions=Media.Class.extend({_size$write:"contain",_aspect$write:"16/9",_position$write:"top left",width:parseUnit(0,"px"),height:parseUnit(0,"px"),ratio:16/9,x:parseUnit(0,"px"),y:parseUnit(0,"px"),constructor:function(a,b,c){a instanceof HTMLElement?(a=a.getBoundingClientRect(),this.width=parseUnit(a.width,"px"),this.height=parseUnit(a.height,"px"),this.ratio=a.width/a.height):a===window?(this.width=parseUnit(window.innerWidth,"px"),this.height=parseUnit(window.innerHeight,"px"),this.ratio=
this.width.value/this.height.value):(this.size=void 0===a?this._size:a,this.aspect=void 0===b?this._aspect:b,this.position=void 0===c?this._position:c)},size$set$snum:function(a){this._size=a;a=a.trim();var b=a.split(" ");a=parseUnit(b[0]||"none");b=parseUnit(b[1]||"none");switch(b.unit){case "auto":case "none":b.value=b.unit;break;case "contain":case "cover":case "fill":case "retain":a.value=b.value=b.unit=a.unit}switch(a.unit){case "auto":case "none":a.value=a.unit;break;case "contain":case "cover":case "fill":case "retain":a.value=
b.value=b.unit=a.unit}this.width=a;this.height=b},size$get$enum:function(){return this._size},aspect$set$enum:function(a){this._aspect=a;a=a.trim();a=a.replace(/:/g," ");a=a.replace(/\//g," ");a=a.replace(/\*/g,"");var b=a.split(" ");a=parseUnit(b[0]||"none");b=parseUnit(b[1]||"none");this.ratio=a.value/b.value},aspect$get$enum:function(){return this._aspect},position$set$enum:function(a){var b=Array(4);a=a.trim();var c=a.split(" ");switch(c.length){case 1:switch(c[0]){case "center":case "none":b[0]=
c[0];b[1]=0;b[2]=c[0];b[3]=0;break;case "left":case "top":case "bottom":b[0]=c[0];b[1]=0;b[2]="none";b[3]=0;break;default:b[0]="left",b[1]=c[0],b[2]="top",b[3]="50%"}break;case 2:switch(c[0]){case "left":case "top":case "bottom":case "center":case "none":b[0]=c[0];b[1]=0;break;default:b[0]="auto",b[1]=c[0]}switch(c[1]){case "left":case "top":case "bottom":case "center":case "none":b[2]=c[0];b[3]=0;break;default:b[2]="auto",b[3]=c[0]}break;case 3:throw"Unable to process a 3 part position '"+a+"'";
case 4:b=c}switch(b[0]){case "auto":switch(b[2]){case "auto":case "top":case "bottom":b[0]="left";break;case "left":case "right":b[0]="top"}}switch(b[2]){case "auto":switch(b[0]){case "auto":case "top":case "bottom":b[2]="left";break;case "left":case "right":b[2]="top"}}switch(b[2]){case "left":case "right":a=b[0],c=b[1],b[0]=b[2],b[1]=b[3],b[2]=a,b[3]=c}this.x={keyword:b[0],value:b[1]};this.y={keyword:b[2],value:b[3]}},position$get$enum:function(){return this._position}});Media.Class.Ended=Media.Class.extend({floorPrecision:10,constructor:function(){this.listenTo(Media,{created:this.onCreated,play:this.onPlay,pause:this.onPause,ended:this.onEnded})},onCreated:function(a){a.defineProperties({hasFiredEnded$write:!1})},onPlay:function(a){a.hasFiredEnded=!1},onPause:function(a){this.isEnded(a)&&!a.isAtEnd&&setTimeout(function(){a.el&&(a.hasFiredEnded||this.isEnded(a)&&a.el.dispatchEvent(createEvent("ended")))}.bind(this),150)},onEnded:function(a){a.hasFiredEnded=!0},isEnded:function(a){return 1>=
Math.abs(Math.floor(a.el.currentTime*this.floorPrecision)-Math.floor(a.el.duration*this.floorPrecision))}});Media.defineProperties({ended:new Media.Class.Ended});Media.Class.PauseOnPlay=Media.Class.extend({constructor:function(){this.listenTo(Media,{created:this.onCreated,play:this.onPlay})},onCreated:function(a){a.defineProperties({pauseonplay$enum$write:a.options.pauseonplay})},onPlay:function(a){a=0;for(var b=Media.players;a<b;a++){var c=Media.players[a];c.pauseonplay&&c.el.pause()}}});Media.defineProperties({pauseonplay:new Media.Class.PauseOnPlay});Media.DefaultOptions.add({pauseonplay:!1});Media.Class.Players=Media.Class.List.extend({constructor:function(){List.apply(this,arguments)},findById:function(a){for(var b=0,c=this.length;b<c;b++){var d=this[b];if(d.el&&d.el.id===a)return d}return null},findByElement:function(a){for(var b=0,c=this.length;b<c;b++){var d=this[b];if(d.el&&d.el.id===a)return d}return null}});Media.defineProperties({players$enum$write:new Media.Class.Players});Media.Class.Resize=Media.Class.extend({constructor:function(a){this.listenTo(Media,{created:this.onCreated,resize:this.onResize});this.addEventListeners()},addEventListeners$write:function(){window.removeEventListener("resize",this.onWindowResize);window.addEventListener("resize",this.onWindowResize);document.addEventListener("fullscreenchange",this.onFullScreenChanged)},onCreated:function(a){this.triggerMediaResize(a)},onFullScreenChanged$write$bind:function(){this.resizeAllPlayers()},onResize:function(a,
b){b.fake||this.resizeAllPlayers()},onWindowResize$write$bind:function(){this.resizeAllPlayers()},resizeAllPlayers$write:function(){for(var a=0,b=Media.players.length;a<b;a++)this.triggerMediaResize(Media.players[a])},triggerMediaResize:function(a){var b=a.options;a.dispatchEvent("resize",{fullscreen:new Media.Class.Dimensions(b.mediafullscreensize,b.mediafullscreenratio,b.mediafullscreenposition),normal:new Media.Class.Dimensions(b.mediasize,b.mediaratio,b.mediaposition)});a.dispatchEvent("postresize",
{fullscreen:new Media.Class.Dimensions(b.mediafullscreensize,b.mediafullscreenratio,b.mediafullscreenposition),normal:new Media.Class.Dimensions(b.mediasize,b.mediaratio,b.mediaposition)})},removeEventListeners$write:function(){window.removeEventListener("resize",this.onWindowResize);document.removeEventListener("fullscreenchange",this.onFullScreenChanged)}});Media.defineProperties({resize$write:new Media.Class.Resize});Media.DOMEvents.add(["resize","postresize"]);
Media.DefaultOptions.add({mediasize:"contain",mediaratio:"16/9",mediaposition:"none none",mediafullscreensize:function(){return this.mediasize},mediafullscreenratio:function(){return this.mediaratio},mediafullscreenposition:function(){return this.mediaposition}});Media.Class.TextTrack=Media.Class.extend({activeCues:null,cues:null,readyState:0,label:null,kind:null,language:null,el:null,media:null,mode:"hidden",_default:!1,default$get$enum:function(){return this._default},default$set$enum:function(a){if(this._default!==a){this._default=a;this.trigger("change",!0);this.media.dispatchEvent("texttrackchange",{track:this});a=0;for(var b=this.activeCues.length;a<b;a++)this.activeCues[a].isLive=!1;this.activeCues.length=0}},constructor:function(a,b){this.cues=[];
this.activeCues=[];this.el=b;this.defineProperties({media$write:a});this.default=null!==this.el.getAttribute("default");this.language=this.el.getAttribute("srclang");this.label=this.el.getAttribute("label");this.kind=this.el.getAttribute("kind");this._previousMode=this.el.mode;this.el.mode="disabled";this.el.track&&(this.el.track.mode="disabled");this.fetch()},addCue:function(a){for(var b=this.cues.length-1;-1<b;b--){var c=this.cues[b];if(c===a||c.id===a.id)return}this.cues.push(a)},removeCue:function(a){for(var b=
this.cues.length-1;-1<b;b--){var c=this.cues[b];c!==a&&c.id!==a.id||this.cues.splice(b,1)}},update$write:function(){if(this.default){this.el.mode="disabled";this.el.track&&(this.el.track.mode="disabled");var a=this.media.el.currentTime,b=this.cues.filter(function(b){return b.startTime<=a&&b.endTime>=a&&!b.isLive}),c=this.activeCues.filter(function(b){return(b.startTime>a||b.endTime<a)&&b.isLive});if(0!==b.length||0!==c.length)c.forEach(function(a){a.isLive=!1}),this.activeCues=this.activeCues.filter(function(b){return!(b.startTime>
a||b.endTime<a)}),this.activeCues.push.apply(this.activeCues,b),b.forEach(function(a){a.isLive=!0}),this.media.dispatchEvent("cuechange",{track:this,media:this})}},fetch$write:function(){this.readyState=Media.Class.TextTrack.READYSTATE.LOADING;getUrl(this.el.src,function(a){a?(this.parse(a)?this.readyState=Media.Class.TextTrack.READYSTATE.LOADED:this.readyState=Media.Class.TextTrack.READYSTATE.ERROR,this.trigger("load",this)):this.readyState=Media.Class.TextTrack.READY_STATE.ERROR},this)},parse$write:function(a){var b=
-1<a.indexOf("\r\n")?"\r\n":"\n";a=a.split(b);b=[];for(var c=[],d=0,e=a.length;d<e;d++){var f=a[d],g=d===a.length-1,l=!f;g&&!l&&c.push(f);if((g||l)&&c.length){if(-1<c[0].toLowerCase().indexOf("webvtt")&&(c.splice(0,1),!c.length))continue;b.push({title:null,lines:c});c=[]}else l||c.push(f)}try{for(d=0,e=b.length;d<e;d++)if(c=b[d],0!==c.lines[0].indexOf("NOTE"))if(0===c.lines[0].indexOf("STYLE"))console.log("Media does not support STYLE lines in WebVTT yet. Please leave an issue if needed.");else{-1===
c.lines[0].indexOf("--\x3e")&&(c.title=c.lines[0],c.lines.shift());if(-1===c.lines[0].indexOf("--\x3e")){this.readyState=Media.Class.TextTrack.READYSTATE.ERROR;break}else extend(c,this.parseTimePlacement(c.lines[0])),c.lines.shift();var h=new Media.Class.TextTrackCue(c.startTime,c.endTime,c.lines.join("\n"));h.defineProperties({track$write:this});h.lineAlign=c.align;h.line=c.line;h.position=c.position;h.size=c.size;h.vertical=c.vertical;this.addCue(h)}}catch(k){return console.log(k),!1}return!0},
parseTimePlacement$write:function(a){a=a.trim();var b=indexOfRegex(a,/--\x3e/);if(-1===b)throw"Time declaration error, no --\x3e";var c=a.slice(0,b).trim();a=a.slice(b);b=indexOfRegex(a,/[0-9]+/);if(-1===b)throw"Time declaration error, no end time";a=a.slice(b);b=indexOfRegex(a,/[ ]{1}/);-1===b&&(b=a.length);var d=a.slice(0,b).trim();a=a.slice(b);return extend({startTime:this.parseTime(c),endTime:this.parseTime(d)},this.parsePlacement(a))},timeUnits$write:[.001,1,60,360],parseTime$write:function(a){a=
a.split(/[:\.,]{1}/g).reverse();if(3>a.length)throw"Time declaration error, mm:ss.ttt or hh:mm:ss.tt";for(var b=0,c=0,d=a.length;c<d;c++)b+=this.timeUnits[c]*parseInt(a[c]);return b},parsePlacement$write:function(a){var b={line:-1,position:"50%",size:"100%",align:"middle"};a.split(" ").filter(function(a){return a}).forEach(function(a){var c=a.split(":");a=c[1].split(",");c=c[0].toLowerCase();switch(c){case "d":c="vertical";break;case "l":c="line";break;case "t":c="position";break;case "s":c="size";
break;case "a":c="align";break;case "vertical":case "line":case "position":case "size":case "align":break;default:throw"Bad position declaration, "+c;}b[c]=a[0]||b[c]});b.vertical="vertical"===b.vertical?"rl":"vertical-lr"===b.vertical?"lr":"horizontal";for(var c in b)switch(a=b[c],c){case "line":a=String(a||-1);break;case "position":a=String(a||"0%");break;case "size":a=String(a||"100%");break;case "align":switch(a=String(a||"middle"),a){case "start":case "middle":case "end":break;default:throw"Invalid align declaration";
}}return b},destroy:function(){for(var a=0,b=this.cues.length;a<b;a++)this.cues[a].destroy();this.el.mode=this._previousMode;this.cues.length=0;this.activeCues.length=0;this.el=this.media=null;this.stopListening()}},{READYSTATE:{NONE:0,LOADING:1,LOADED:2,ERROR:3}});Media.DOMEvents.add(["texttrackchange","cuechange"]);Media.Class.TextTrackCue=Media.Class.extend({region:null,id:null,startTime:null,endTime:null,vertical:null,snapToLines:null,line:null,lineAlign:null,position:null,positionAlign:null,size:null,textAlign:null,text:null,track$write:null,_isLive$write:!1,isLive$get$enum:function(){return this._isLive},isLive$set$enum:function(a){var b;!this._isLive&&a?b="enter":this._isLive&&!a&&(b="exit");b&&(this._isLive=a,this.trigger(b,this),this.track.media.dispatchEvent("cue"+b,{cue:this}))},constructor:function(a,
b,c){this.id="cue-"+ ++Media.Class.TextTrackCue.id;this.startTime=a;this.endTime=b;this.text=c;this.defineProperties({_isLive$write:!1,track$write:!1})},getCueAsHTML:function(){var a=this.track.media.options.classprefix,b=document.createElement("span"),c={id:this.id,lang:this.track.language,class:a+"cue",style:""};this.renderCuePlacement(c,this);for(var d in c)b.setAttribute(d,c[d]);c=document.createElement("span");c.setAttribute("class",a+"cue-text");c.innerHTML='<span class="'+a+'cue-line">'+this.text.replace(/\n/g,
'</span><br><span class="'+a+'cue-line">')+"</span>";b.appendChild(c);return b},renderCuePlacement$write:function(a,b){var c=this.track.media.options.classprefix,d=a["class"].split(" ");d.push(c+"cue-"+b.vertical);var e="position: absolute;";switch(b.vertical){case "horizontal":e+="transform: translateX(-50%);";switch(b.lineAlign){case "start":e+="text-align: left;";d.push(c+"cue-align-left");break;case "middle":e+="text-align: center;";d.push(c+"cue-align-center");break;case "end":e+="text-align: right;",
d.push(c+"cue-align-right")}e+="width:"+b.size+";";e+="left:"+b.position+";";e=(c=-1<String(b.line).indexOf("%"))||0<=b.line?e+("top:"+b.line+"%"):e+("bottom:"+(100-100*Math.abs(b.line))+"%");break;case "rl":e+="transform: translateY(-50%);";switch(b.lineAlign){case "start":e+="text-align: left;";d.push(c+"cue-align-top");break;case "middle":e+="text-align: center;";d.push(c+"cue-align-middle");break;case "end":e+="text-align: right;",d.push(c+"cue-align-bottom")}e+="height:"+b.size+";";e+="top:"+
b.position+";";e=(c=-1<String(b.line).indexOf("%"))||0<=b.line?e+("left:"+b.line+"%"):e+("right:"+(100-100*Math.abs(b.line))+"%");break;case "lr":e+="transform: translateY(-50%);";switch(b.lineAlign){case "start":e+="text-align: left;";d.push(c+"cue-align-top");break;case "middle":e+="text-align: center;";d.push(c+"cue-align-middle");break;case "end":e+="text-align: right;",d.push(c+"cue-align-bottom")}e+="height:"+b.size+";";e+="top:"+b.position+";";(c=-1<String(b.line).indexOf("%"))||0<=b.line?
e+="right:"+b.line+"%":(b=100-100*Math.abs(b.line),e+="left:"+b+"%")}a["class"]=d.join(" ");a.style=e;return a},destroy:function(){this.media=null}},{id:0});Media.DOMEvents.add(["cueenter","cueexit"]);Media.Class.TextTrackList=Media.Class.List.extend({media$write:null,constructor:function(a){this.defineProperties({media$write:a});this.fetch()},default$get:function(){return this.find(function(a){return a.default})},fetch$write:function(){this.destroy();var a={},b=this.media.el.querySelectorAll("track[type='text/vtt']");toArray(b).forEach(function(b){var c=b.getAttribute("srclang"),e=b.getAttribute("src");c&&e&&!a[c]&&(a[c]=new Media.Class.TextTrack(this.media,b))},this);this.addTracks(ObjectValues(a))},
addTracks$write:function(a){for(var b=0,c=a.length;b<c;b++)this.addTrack(a[b])},addTrack:function(a){for(var b=0,c=this.length;b<c;b++)if(this[b]===a)return;this.push(a);this.trigger("add",a,this);this.media.dispatchEvent("addtexttrack",{track:a})},removeTrack:function(a){for(var b=!1,c=this.length-1;-1<c;c--)this[c]===a&&(this.splice(c,1),b=!0);b&&(this.trigger("remove",a,this),this.media.dispatchEvent("removetexttrack",{track:a}))},getTrackById:function(a){for(var b=0,c=this.length;b<c;b++)if(this[b].el.id===
a)return this[b];return null},destroy:function(){for(var a=0,b=this.length;a<b;a++)this[a].destroy();this.length=0;this.stopListening()}});Media.DOMEvents.add(["addtexttrack","removetexttrack"]);Media.Class.TextTracks=Media.Class.extend({constructor:function(a){this.listenTo(Media,{create:this.onCreate,timeupdate:this.onTimeUpdate,destroy:this.onDestroy})},onCreate:function(a){a.defineProperties({tracks$enum$write:new Media.Class.TextTrackList(a)})},onTimeUpdate:function(a,b){if(b.slow){b=0;for(var c=a.tracks.length;b<c;b++)a.tracks[b].update()}},onDestroy:function(a){a.tracks&&(a.tracks.destroy(),delete a.tracks)}},null,{instanceEvents:!0});Media.defineProperties({texttracks$write:new Media.Class.TextTracks});Media.Class.TimeUpdate=Media.Class.extend({playing:null,interval:null,slowInterval:null,inRaf:!1,lastTickTime:null,slowLastTickTime:null,mediumLastTickTime:null,constructor:function(){this.playing=[];this.listenTo(Media,{play:this.onPlay,"pause finish destroyed":this.onPause});this.onRaf=this.onRaf.bind(this)},onPlay:function(a){for(var b=0,c=this.playing.length;b<c;b++)if(this.playing[b]===a)return;this.playing.push(a);this.inRaf||(rafer.request(this.onRaf),this.inRaf=!0)},onRaf:function(){var a=
Media.DefaultOptions.get("fpsfast");this.interval=1E3/a;this.mediumInterval=1E3/(Media.DefaultOptions.get("fpsmedium")||a/2);this.slowInterval=1E3/(Media.DefaultOptions.get("fpsslow")||a/3);var b=Date.now();if(b<this.lastTickTime+this.interval)return this.playing.length?rafer.request(this.onRaf):this.inRaf=!1;a={fast:!0,medium:!1,slow:!1};b>=this.mediumLastTickTime+this.mediumInterval&&(this.mediumLastTickTime=b,a.medium=!0);b>=this.slowLastTickTime+this.slowInterval&&(this.slowLastTickTime=b,a.slow=
!0);this.lastTickTime=b;b=0;for(var c=this.playing.length;b<c;b++)this.playing[b].dispatchEvent("timeupdate",a);return rafer.request(this.onRaf)},onPause:function(a){for(var b=this.playing.length-1;-1<b;b--)this.playing[b]===a&&this.playing.splice(b,1)}},null,{instanceEvents:!0});Media.defineProperties({timeupdate$write:new Media.Class.TimeUpdate});Media.DefaultOptions.add({fpsfast:60,fpsmedium:30,fpsslow:12});Media.defineProperties({utils$write:{}});Media.utils.Rafer=Rafer;Media.utils.rafer=rafer;Media.utils.Class=Class;Media.utils.List=List;Media.utils.Elements=Elements;Media.utils.elements=elements;Media.utils.Events=Events;Media.utils.EventsInitialize=EventsInitialize;Media.utils.EventsArgumentsNotation=EventsArgumentsNotation;Media.utils.EventRegister=EventRegister;Media.utils.EventsRegistry=EventsRegistry;Media.utils.properties=properties;Media.utils.toArray=toArray;Media.utils.isArray=isArray;
Media.utils.isObject=isObject;Media.utils.extend=extend;Media.utils.extendNotEnumerable=extendNotEnumerable;Media.utils.deepDefaults=deepDefaults;Media.utils.defaults=defaults;Media.utils.indexOfRegex=indexOfRegex;Media.utils.lastIndexOfRegex=lastIndexOfRegex;Media.utils.includes=includes;Media.utils.replace=replace;Media.utils.parseUnit=parseUnit;Media.utils.delay=delay;Media.utils.debounce=debounce;Media.utils.toggleClass=toggleClass;Media.utils.removeAttribute=removeAttribute;
Media.utils.removeElement=removeElement;Media.utils.toggleClass=toggleClass;Media.utils.prependElement=prependElement;Media.utils.createEvent=createEvent;MediaUI.defineProperties({Language$write:Class.extend({constructor:function(a){defaults(this,a);this.defineProperties({_isLoaded$write:!1,_hash$write:null})},isLoaded$get$enum:function(){return this._isLoaded},hash$set$enum:function(a){this._hash=a;this._isLoaded=!0;MediaUI.languages.trigger("language:"+this.langCode,this)},hash$get$enum:function(){return this._hash}})});MediaUI.defineProperties({Languages:List.extend({constructor:function(){},load$enum$write:function(a,b){a=a||{};a.uilangcode=a.uilangcode||"en";a.uilangpath=a.uilangpath||"./lang/";a.uilangextension=a.uilangextension||".txt";var c=this.search(a.uilangcode);this.once("language:"+a.uilangcode,function(a){b&&b(a)});c?c.isLoaded&&MediaUI.languages.trigger("language:"+a.uilangcode,c):(c=this.add({langCode:a.uilangcode}),getUrl(a.uilangpath+a.uilangcode+a.uilangextension,function(a){c.hash=JSON.parse(a)}.bind(this),
function(){throw"Could not find media player language `"+a.uilangcode+"`";}.bind(this)))},add$enum$write:function(a,b){a=new MediaUI.Language(a,b);this.push(a);return a},search$enum$write:function(a){for(var b,c=0,d=this.length;c<d;c++){var e=this[c];if(e.langCode===a){b=e;break}}return b||null}},null,{instanceEvents:!0})});MediaUI.defineProperties({languages$enum$write:new MediaUI.Languages});Media.DefaultOptions.add({uilangcode:"en",uilangpath:"./lang/",uilangextension:".txt"});MediaUI.defineProperties({Layout$write:Class.extend({constructor:function(a){defaults(this,a);this.defineProperties({_isLoaded$write:!1,_template$write:null})},isLoaded$get$enum:function(){return this._isLoaded},template$set$enum:function(a){this._template=a;this._isLoaded=!0;MediaUI.layouts.trigger("layout:"+this.langCode,this)},template$get$enum:function(){return this._template}})});MediaUI.defineProperties({Layouts:List.extend({constructor:function(){},load$enum$write:function(a,b){a=a||{};a.uilayoutname=a.uilayoutname||"default";a.uilayoutpath=a.uilayoutpath||"./layout/";a.uilayoutextension=a.uilayoutextension||".html";var c=this.search(a.uilayoutname);this.once("layout:"+a.uilayoutname,function(a){b&&b(a)});c?c.isLoaded&&MediaUI.layouts.trigger("layout:"+a.uilayoutname,c):(c=this.add({langCode:a.uilayoutname}),getUrl(a.uilayoutpath+a.uilayoutname+a.uilayoutextension,function(a){c.template=
a}.bind(this),function(){throw"Could not find media player layout `"+a.uilayoutname+"`";}.bind(this)))},add$enum$write:function(a,b){a=new MediaUI.Layout(a,b);this.push(a);return a},search$enum$write:function(a){for(var b,c=0,d=this.length;c<d;c++){var e=this[c];if(e.langCode===a){b=e;break}}return b||null}},null,{instanceEvents:!0})});MediaUI.defineProperties({layouts$enum$write:new MediaUI.Layouts});Media.DefaultOptions.add({uilayout:null,uilayoutpath:"./layout/",uilayoutname:"default",uilayoutextension:".html"});MediaUI.Controller.Captions=MediaUI.Controller.extend({ui:null,constructor:function(a){MediaUI.Controller.apply(this,arguments);this.ui=a},isActive$get$enum:function(){return!!this.ui.media.tracks.default}});MediaUI.Controller.FullScreen=MediaUI.Controller.extend({ui:null,constructor:function(a){MediaUI.Controller.apply(this,arguments);this.ui=a},isActive$get$enum:function(){return this.ui.el===document.fullscreenElement||document.fullscreenElement===this.ui.source},type$get$enum:function(){return window.fullscreenPolyfill.useFullWindow?"fullwindow":"browser"}});MediaUI.Input.Engage=MediaUI.Input.extend({ui:null,isEngaged:!1,engageHandle:null,constructor:function(a){MediaUI.Input.apply(this,arguments);this.ui=a;this.setUpListeners()},setUpListeners:function(){this.listenTo(this.ui,{begininput:this.onBeginInput,tap:this.onTap,endinput:this.onEndInput,ready:this.onUIReady});this.listenTo(this.ui.media,{play:this.startDisengage,"pause skip":this.engage})},onUIReady$bind:function(){this.engage()},onBeginInput$bind:function(a){this.ui.media.el.paused||(this.isInInput=
!0,Media.device.wasTouchedRecently||(this.stopDisengage(),this.engage()))},onTap$bind:function(a){this.ui.media.el.paused||this.checkForceEngage(a)||(this.isEngaged&&Media.device.wasTouchedRecently?this.disengage():this.engage())},onEndInput$bind:function(a){this.ui.media.el.paused||Media.device.wasTouchedRecently||this.checkForceEngage(a)||this.startDisengage()},checkForceEngage:function(a){if("mouseout"===a.type)return!1;a=elements(a.target);return a.stack().filterByAttribute(this.ui.options.inputattribute,
"engage").length&&!a.isHidden()?(this.stopDisengage(),!0):!1},engage$bind:function(){this.isEngaged||(this.isEngaged=!0,this.ui.trigger("engage"))},disengage$bind:function(){this.isEngaged&&(this.isEngaged=!1,this.ui.trigger("disengage"))},startDisengage:function(){this.isEngaged&&(this.engageHandle&&this.stopDisengage(),this.engageHandle=setTimeout(this.disengage,this.ui.options.uiengagetimeout||2E3))},stopDisengage:function(){this.engageHandle&&(clearTimeout(this.engageHandle),this.engageHandle=
null)},destroy:function(){MediaUI.Input.prototype.destroy.apply(this,arguments);this.ui=null}});Media.DefaultOptions.add({uiengagetimeout:2E3});MediaUI.Input.ScrubCurrentTime=MediaUI.Input.extend({ui:null,$els:null,wasPlaying:!1,isMouseDown:!1,inTouch:!1,constructor:function(a){MediaUI.Input.apply(this,arguments);this.ui=a;this.$els=this.ui.$all().filterByAttribute(this.ui.options.inputattribute,"scrubcurrenttime");this.addEventListeners()},addEventListeners:function(){this.$els.on({mousedown:this.onMouseDown,touchstart:this.onTouchStart},{passive:!1});elements(document.body).on({mouseup:this.onMouseUp,mousemove:this.onMouseMove},{passive:!0});
elements(document.body).on({touchend:this.onTouchEnd,touchmove:this.onTouchMove},{passive:!1})},onMouseDown$bind:function(a){a.buttons&1&&(a.stopPropagation(),this.wasPlaying=!this.ui.source.paused,this.isMouseDown=!0,this.ui.source.pause(),this.setTimeFromLeft(a.clientX))},onMouseMove$bind:function(a){if(this.isMouseDown)if(a.buttons&1)this.setTimeFromLeft(a.clientX);else this.onMouseUp()},onMouseUp$bind:function(){this.isMouseDown=!1;this.wasPlaying&&(this.wasPlaying=!1,this.ui.source.play())},
onTouchStart$bind:function(a){this.wasPlaying=!this.ui.source.paused;this.inTouch=!0;this.ui.source.pause();this.setTimeFromLeft(a.touches[0].clientX)},onTouchMove$bind:function(a){this.inTouch&&this.setTimeFromLeft(a.touches[0].clientX)},onTouchEnd$bind:function(a){this.inTouch=!1;this.wasPlaying&&(a.stopPropagation(),this.wasPlaying=!1,this.ui.source.play())},setTimeFromLeft:function(a){if(this.ui.source.duration){var b=this.$els[0].getBoundingClientRect(),c=this.$els[0].clientWidth;a=clamp(0,a-
b.left,c);this.ui.source.currentTime=a/c*this.ui.source.duration;this.ui.media.dispatchEvent("timeupdate",{slow:!0})}},removeEventListeners:function(){this.$els.off({mousedown:this.onMouseDown,touchstart:this.onTouchStart});elements(document.body).off({mouseup:this.onMouseUp,mousemove:this.onMouseMove,touchend:this.onTouchEnd,touchmove:this.onTouchMove},{passive:!0})},destroy:function(){MediaUI.Input.prototype.destroy.apply(this,arguments);this.removeEventListeners();this.$els=this.ui=null}});MediaUI.Input.ScrubCurrentTimeAria=MediaUI.Input.extend({ui:null,$els:null,wasPlaying:!1,isMouseDown:!1,inTouch:!1,constructor:function(a){MediaUI.Input.apply(this,arguments);this.ui=a;this.$els=this.ui.$all().filterByAttribute(this.ui.options.inputattribute,"scrubcurrenttimearia");this.addEventListeners()},addEventListeners:function(){this.$els.on({keydown:this.onKeyDown},{passive:!1})},onKeyDown$bind:function(a){if(a.target===document.activeElement)switch(a.keyCode){case 37:case 40:this.moveTimeBySeconds(-1);
break;case 39:case 38:this.moveTimeBySeconds(1);break;case 34:this.moveTimeBySeconds(-10);break;case 33:this.moveTimeBySeconds(10);break;case 35:this.moveTimeBySeconds(this.ui.source.duration||0);break;case 36:this.moveTimeBySeconds(-this.ui.source.duration||0)}},moveTimeBySeconds:function(a){this.ui.source.duration&&(a=clamp(0,this.ui.source.currentTime+a,this.ui.source.duration),this.ui.source.currentTime=a,this.ui.media.dispatchEvent("timeupdate",{slow:!0}))},removeEventListeners:function(){this.$els.off({keydown:this.onKeyDown})},
destroy:function(){MediaUI.Input.prototype.destroy.apply(this,arguments);this.removeEventListeners();this.$els=this.ui=null}});MediaUI.Input.Skip=MediaUI.Input.extend({floorPrecision:10,ui:null,interactions:null,lastEvent:0,skipped:0,constructor:function(a){MediaUI.Input.apply(this,arguments);a.options.canskip&&(this.interactions=[],this.clear=debounce(this.clear.bind(this),500),this.ui=a,this.listenTo(this.ui,{tap:this.onSingleTap,dbltap:this.onDoubleTap}))},onSingleTap:function(a){Media.device.wasTouchedRecently&&(this.interactions.length=0)},onDoubleTap$bind:function(a){if(Media.device.wasTouchedRecently&&elements(a.target).stack().filterByAttribute(this.ui.options.inputattribute,
"skip").length){a.preventDefault();Date.now();var b=a.target.offsetParent,c=b.getBoundingClientRect();a=("touchend"===a.type?a.changedTouches[0].clientX-c.left:a.offsetX)/b.clientWidth;this.interactions.push({direction:.5>a?"left":.5<a?"right":"none"});this.skip();this.clear()}},skip:function(){var a=this.getSkipAmount();if(a){var b=a-this.skipped,c=this.ui.source.currentTime;if(b=clamp(-c,b,this.ui.source.duration-c))this.ui.source.currentTime+=b,this.skipped+=b,this.ui.media.dispatchEvent("skip",
{skipAmount:a}),this.ui.media.dispatchEvent("timeupdate",{fast:!0,medium:!0,slow:!0})}},clear:function(){this.getSkipAmount()&&(this.skipped=this.interactions.length=0)},getSkipAmount:function(){var a=this.interactions.slice(0);if(void 0!==a){for(var b=this.ui.options.skipseconds||10,c=0,d=0,e=0,f=a.length;e<f;e++)switch(a[e].direction){case "left":d++;break;case "right":c++}if((c||d)&&0!==c-d)return(d>c?-(d-c):c-d)*b}}});Media.DefaultOptions.add({canskip:!0,skipseconds:10});Media.DOMEvents.add("skip");MediaUI.Input.Taps=MediaUI.Input.extend({ui:null,$els:null,isMouseDown:!1,isTouchDown:!1,lastEnd:0,taps:0,tapHandle:null,constructor:function(a){MediaUI.Input.apply(this,arguments);this.ui=a;this.$els=this.ui.$("*").filterByAttribute(this.ui.options.inputattribute,"taps");this.setUpListeners()},setUpListeners:function(){this.listenTo(this.ui,{stoptap:this.stopSingleTap});this.$els.on({touchstart:this.onTouchStart,mousedown:this.onMouseDown},{passive:!1});this.$els.on({mousemove:this.onMouseMove,mouseout:this.onMouseOut},
{passive:!0});elements(document.body).on({mouseup:this.onMouseUp,touchend:this.onTouchEnd},{passive:!1})},onTouchStart$bind:function(a){this.isTouchDown=!0;this.ui.trigger("begininput",a)},onMouseDown$bind:function(a){!Media.device.wasTouchedRecently&&!this.isTouchDown&&a.buttons&1&&(this.isMouseDown=!0,this.ui.trigger("begininput",a))},onMouseMove$bind:function(a){Media.device.wasTouchedRecently||this.isMouseDown||this.isTouchDown||this.tapHandle||(this.ui.trigger("begininput",a),this.ui.trigger("endinput",
a))},onMouseOut$bind:function(a){Media.device.wasTouchedRecently||this.isMouseDown||this.isTouchDown||this.ui.trigger("endinput",a)},onMouseUp$bind:function(a){!Media.device.wasTouchedRecently&&this.isMouseDown&&(this.isMouseDown=!1,this.ui.trigger("endinput",a),this.onEndInput(a))},onTouchEnd$bind:function(a){this.isTouchDown&&(this.isTouchDown=!1,this.ui.trigger("endinput",a),this.onEndInput(a))},onEndInput$bind:function(a){this.stopSingleTap();if(!this.isNoTaps(a)){this.taps++;var b=Date.now();
b-this.lastEnd<(this.ui.options.uitapinterval||500)?2<=this.taps&&(this.ui.trigger("dbltap",a),this.taps=0):(this.singleTapEvent=a,this.startSingleTap());this.lastEnd=b}},startSingleTap:function(){this.tapHandle&&this.stopSingleTap();this.tapHandle=setTimeout(this.triggerSingleTap,this.ui.options.uitapinterval||500)},stopSingleTap:function(){this.tapHandle&&(clearTimeout(this.tapHandle),this.tapHandle=null)},triggerSingleTap$bind:function(){clearTimeout(this.tapHandle);this.tapHandle=null;0!==this.taps&&
(this.taps=0,this.ui.trigger("tap",this.singleTapEvent))},isNoTaps:function(a){return elements(a.target).stack().filterByAttribute(this.ui.options.inputattribute,"stoptappropagation").length},destroy:function(){MediaUI.Input.prototype.destroy.apply(this,arguments);this.$els.off({touchstart:this.onTouchStart,mousedown:this.onMouseDown,mousemove:this.onMouseMove,mouseout:this.onMouseOut});elements(document.body).off({mouseup:this.onMouseUp,touchend:this.onTouchEnd});this.$els=this.ui=null}});Media.DefaultOptions.add({uitapinterval:300});MediaUI.Input.ToggleCaptions=MediaUI.Input.extend({ui:null,$els:null,constructor:function(a){MediaUI.Input.apply(this,arguments);this.ui=a;this.$els=this.ui.$all().filterByAttribute(this.ui.options.inputattribute,"togglecaptions");this.$els.on({click:this.onClick})},onClick$bind:function(){this.ui.captions.isActive?this.ui.media.tracks.default.default=!1:this.ui.media.tracks.length&&(this.ui.media.tracks[0].default=!0)},destroy:function(){MediaUI.Input.prototype.destroy.apply(this,arguments);this.$els.off("click",
this.onClick);this.ui=null}});MediaUI.Input.ToggleFullScreen=MediaUI.Input.extend({ui:null,$els:null,constructor:function(a){MediaUI.Input.apply(this,arguments);this.ui=a;this.$els=this.ui.$all().filterByAttribute(this.ui.options.inputattribute,"togglefullscreen");this.$els.on({click:this.onClick});this.listenTo(this.ui,{dbltap:this.onDoubleTap})},onClick$bind:function(){var a=this.ui.options;this.ui.options.usefullwindow&&(window.fullscreenPolyfill.useFullWindow=!0);Media.device.isIOS&&a.iosnativefullscreen?document.fullscreenElement?
document.exitFullscreen():this.ui.source.requestFullscreen():document.fullscreenElement?document.exitFullscreen():this.ui.el.requestFullscreen()},onDoubleTap$bind:function(){if(!Media.device.wasTouchedRecently)this.onClick()},destroy:function(){MediaUI.Input.prototype.destroy.apply(this,arguments);this.$els.off("click",this.onClick);this.ui=null}});Media.DefaultOptions.add({iosnativefullscreen:!0,usefullwindow:!1});MediaUI.Input.ToggleMute=MediaUI.Input.extend({ui:null,$els:null,constructor:function(a){MediaUI.Input.apply(this,arguments);this.ui=a;this.$els=this.ui.$all().filterByAttribute(this.ui.options.inputattribute,"togglemute");this.$els.on({click:this.onClick})},onClick$bind:function(){this.ui.source.muted=!this.ui.source.muted},destroy:function(){MediaUI.Input.prototype.destroy.apply(this,arguments);this.$els.off("click",this.onClick);this.ui=null}});MediaUI.Input.TogglePlayPause=MediaUI.Input.extend({ui:null,$els:null,constructor:function(a){MediaUI.Input.apply(this,arguments);this.$els=a.$all().filterByAttribute(a.options.inputattribute,"toggleplaypause");this.$els.length&&(this.ui=a,this.$els.on({click:this.onClick}),this.listenTo(this.ui,{tap:this.onTap}))},onClick$bind:function(a){a.stopPropagation();elements(a.target).isHidden()||(this.ui.trigger("stoptap"),this.toggle())},onTap$bind:function(a){a=elements(a.target);var b=a.stack().filterByAttribute(this.ui.options.inputattribute,
"toggleplaypausenotouch");a.isHidden()||!b.length||Media.device.wasTouchedRecently||this.toggle()},toggle:function(){this.ui.source.paused?this.ui.source.play():this.ui.source.pause()},destroy:function(){MediaUI.Input.prototype.destroy.apply(this,arguments);this.$els.off("click",this.onClick);this.ui=null}});MediaUI.Output.BufferedWidth=MediaUI.Output.extend({floorPrecision:10,ui:null,$els:null,constructor:function(a){MediaUI.Output.apply(this,arguments);this.$els=a.$all().filterByAttribute(a.options.outputattribute,"bufferedwidth");this.$els.length&&(this.ui=a,this.listenTo(this.ui.media,{"timeupdate postresize ended":this.onTimeUpdate,destroyed:this.destroy}),this.onTimeUpdate())},onTimeUpdate:function(a){a&&"timeupdate"===a.type&&!a.medium||this.update()},update:function(){if(this.$els.length){var a=
this.ui.source.duration,b=this.ui.source.buffered;!b.length&&this.ui.source.seekable.length&&(b=this.ui.source.seekable);for(var c=0,d=0,e=b.length;d<e;d++){var f=b.end(d);c<f&&(c=f)}a=(c-0)/a||0;c=0;for(d=this.$els.length;c<d;c++)b=this.$els[c],rafer.set(b.style,"width",100*a+"%")}},destroy:function(){MediaUI.Output.prototype.destroy.apply(this,arguments);this.$els=this.ui=null}});MediaUI.Output.Captions=MediaUI.Output.extend({ui:null,$els:null,constructor:function(a){MediaUI.Output.apply(this,arguments);this.ui=a;this.getElements();this.setUpListeners()},getElements:function(){this.$els=this.ui.$("*:not(track)").filterByAttribute(this.ui.options.outputattribute,"captions")},setUpListeners:function(){this.listenTo(this.ui.media,{texttrackchange:this.onTextTrackChange,cueenter:this.onCueEnter,cueexit:this.onCueExit})},onTextTrackChange$bind:function(a){this.$els.forEach(function(a){rafer.set(a,
"innerHTML","")})},onCueEnter$bind:function(a){this.$els.forEach(function(b){rafer.call(b,"appendChild",a.cue.getCueAsHTML())})},onCueExit$bind:function(a){this.$els.forEach(function(b){b=b.querySelectorAll("#"+a.cue.id);for(var c=0,d=b.length;c<d;c++)rafer.call(removeElement,null,b[c])})},destroy:function(){MediaUI.Output.prototype.destroy.apply(this,arguments);this.$els=this.ui=null}});MediaUI.Output.CaptionsAria=MediaUI.Output.extend({ui:null,$els:null,constructor:function(a){MediaUI.Output.apply(this,arguments);this.$els=a.$all().filterByAttribute(a.options.outputattribute,"captionsaria");this.$els.length&&(this.ui=a,this.listenTo(this.ui.media,{texttrackchange:this.onUpdate}),this.onUpdate())},onUpdate:function(a){this.$els.length&&MediaUI.languages.load(this.ui.options,function(a){var b=this.ui.captions.isActive;a=b?replace("${Captions}",a.hash):replace("${captions off}",a.hash);
rafer.call(this.$els,"attr","aria-label",a);rafer.call(this.$els,"attr","aria-pressed",b)}.bind(this))},destroy:function(){MediaUI.Output.prototype.destroy.apply(this,arguments);this.$els=this.ui=null}});MediaUI.Output.CaptionsState=MediaUI.Output.extend({ui:null,el:null,constructor:function(a){MediaUI.Output.apply(this,arguments);if(this.el=a.$all().filterByAttribute(a.options.outputattribute,"captionsstate")[0])this.ui=a,this.listenTo(this.ui.media,{texttrackchange:this.onTextTrackChange}),this.onTextTrackChange()},onTextTrackChange$bind:function(a){rafer.call(toggleClass,null,this.el,this.ui.options.classprefix+"captionsstate-active",this.ui.captions.isActive)},destroy:function(){MediaUI.Output.prototype.destroy.apply(this,
arguments);this.el=this.ui=null}});MediaUI.Output.CurrentTimeAria=MediaUI.Output.extend({ui:null,$els:null,constructor:function(a){MediaUI.Output.apply(this,arguments);this.$els=a.$all().filterByAttribute(a.options.outputattribute,"currenttimearia");this.$els.length&&(this.ui=a,this.listenTo(this.ui.media,{timeupdate:this.onUpdate}),this.onUpdate())},onUpdate:function(a){(!a||a.fake&&a.medium)&&this.$els.length&&MediaUI.languages.load(this.ui.options,function(a){var b=parseInt(this.ui.source.currentTime),d=parseInt(this.ui.source.duration||
0);a=a.hash["Progress Bar"]+" "+a.hash["progress bar timing: currentTime={1} duration={2}"].replace("{1}",b).replace("{2}",d);rafer.call(this.$els,"attr","role","slider");rafer.call(this.$els,"attr","tabindex","0");rafer.call(this.$els,"attr","aria-valuemax",d);rafer.call(this.$els,"attr","aria-valuemin",0);rafer.call(this.$els,"attr","aria-valuenow",b);rafer.call(this.$els,"attr","aria-label",a)}.bind(this))},destroy:function(){MediaUI.Output.prototype.destroy.apply(this,arguments);this.$els=this.ui=
null}});MediaUI.Output.CurrentTimeWidth=MediaUI.Output.extend({ui:null,$els:null,constructor:function(a){MediaUI.Output.apply(this,arguments);this.$els=a.$all().filterByAttribute(a.options.outputattribute,"currenttimewidth");this.$els.length&&(this.ui=a,this.listenTo(this.ui.media,{"timeupdate postresize ended":this.onTimeUpdate,destroyed:this.destroy}),this.onTimeUpdate())},onTimeUpdate:function(a){a&&"timeupdate"===a.type&&!a.medium||this.update()},update:function(){if(this.$els.length)for(var a=this.ui.source.currentTime/
this.ui.source.duration||0,b=0,c=this.$els.length;b<c;b++)rafer.set(this.$els[b].style,"width",100*a+"%")},destroy:function(){MediaUI.Output.prototype.destroy.apply(this,arguments);this.$els=this.ui=null}});MediaUI.Output.EngageState=MediaUI.Output.extend({ui:null,$els:null,constructor:function(a){MediaUI.Output.apply(this,arguments);this.$els=a.$all().filterByAttribute(a.options.outputattribute,"engagestate");this.$els.length&&(this.ui=a,this.listenTo(this.ui,{engage:this.onEngage,disengage:this.onDisengage}))},onEngage$bind:function(){rafer.call(this.$els,"toggleClass",replace("${classprefix}engagestate-engaged",this.ui.options),!0);rafer.call(this.$els,"toggleClass",replace("${classprefix}engagestate-disengaged",
this.ui.options),!1)},onDisengage$bind:function(){rafer.call(this.$els,"toggleClass",replace("${classprefix}engagestate-disengaged",this.ui.options),!0);rafer.call(this.$els,"toggleClass",replace("${classprefix}engagestate-engaged",this.ui.options),!1)},destroy:function(){MediaUI.Output.prototype.destroy.apply(this,arguments);this.$els=this.ui=null}});MediaUI.Output.FullScreenAria=MediaUI.Output.extend({ui:null,$els:null,constructor:function(a){MediaUI.Output.apply(this,arguments);this.$els=a.$all().filterByAttribute(a.options.outputattribute,"fullscreenaria");this.$els.length&&(this.ui=a,this.listenTo(this.ui.media,{resize:this.onUpdate}),this.onUpdate())},onUpdate:function(a){this.$els.length&&MediaUI.languages.load(this.ui.options,function(a){var b=this.ui.fullscreen.isActive;a=b?replace("${Fullscreen}",a.hash):replace("${Non-Fullscreen}",a.hash);
rafer.call(this.$els,"attr","aria-label",a);rafer.call(this.$els,"attr","aria-pressed",b)}.bind(this))},destroy:function(){MediaUI.Output.prototype.destroy.apply(this,arguments);this.$els=this.ui=null}});MediaUI.Output.FullScreenState=MediaUI.Output.extend({ui:null,el:null,constructor:function(a){MediaUI.Output.apply(this,arguments);if(this.el=a.$all().filterByAttribute(a.options.outputattribute,"fullscreenstate")[0])this.ui=a,this.listenTo(this.ui.media,{resize:this.onResize})},onResize$bind:function(a){rafer.call(toggleClass,null,this.el,this.ui.options.classprefix+"fullscreenstate-"+this.ui.fullscreen.type,this.ui.fullscreen.isActive)},destroy:function(){MediaUI.Output.prototype.destroy.apply(this,
arguments);this.el=this.ui=null}});MediaUI.Output.MuteAria=MediaUI.Output.extend({ui:null,$els:null,constructor:function(a){MediaUI.Output.apply(this,arguments);this.$els=a.$all().filterByAttribute(a.options.outputattribute,"mutearia");this.$els.length&&(this.ui=a,this.listenTo(this.ui.media,{volumechange:this.onUpdate}),this.onUpdate())},onUpdate:function(a){this.$els.length&&MediaUI.languages.load(this.ui.options,function(a){var b=this.ui.source.muted;a=b?replace("${Unmute}",a.hash):replace("${Mute}",a.hash);rafer.call(this.$els,
"attr","aria-label",a);rafer.call(this.$els,"attr","aria-pressed",b)}.bind(this))},destroy:function(){MediaUI.Output.prototype.destroy.apply(this,arguments);this.$els=this.ui=null}});MediaUI.Output.MuteState=MediaUI.Output.extend({ui:null,$els:null,constructor:function(a){MediaUI.Output.apply(this,arguments);this.$els=a.$all().filterByAttribute(a.options.outputattribute,"mutestate");this.$els.length&&(this.ui=a,this.listenTo(this.ui.media,{volumechange:this.onVolumeChange}),this.onVolumeChange())},onVolumeChange$bind:function(){rafer.call(this.$els,"toggleClass",replace("${classprefix}mutestate-muted",this.ui.options),this.ui.source.muted)},destroy:function(){MediaUI.Output.prototype.destroy.apply(this,
arguments);this.$els=this.ui=null}});MediaUI.Output.PlayPauseAria=MediaUI.Output.extend({ui:null,$els:null,constructor:function(a){MediaUI.Output.apply(this,arguments);this.$els=a.$all().filterByAttribute(a.options.outputattribute,"playpausearia");this.$els.length&&(this.ui=a,this.listenTo(this.ui.media,{"play pause":this.onUpdate}),this.onUpdate())},onUpdate:function(a){this.$els.length&&MediaUI.languages.load(this.ui.options,function(a){var b=this.ui.source.paused;a=b?replace("${Play}",a.hash):replace("${Pause}",a.hash);rafer.call(this.$els,
"attr","aria-label",a);rafer.call(this.$els,"attr","aria-pressed",b?"false":"true")}.bind(this))},destroy:function(){MediaUI.Output.prototype.destroy.apply(this,arguments);this.$els=this.ui=null}});MediaUI.Output.PlayPauseState=MediaUI.Output.extend({floorPrecision:10,ui:null,$els:null,constructor:function(a){MediaUI.Output.apply(this,arguments);this.$els=a.$all().filterByAttribute(a.options.outputattribute,"playpausestate");this.$els.length&&(this.ui=a,this.listenTo(this.ui.media,{"timeupdate play pause ended":this.onTimeUpdate}),this.onTimeUpdate())},onTimeUpdate:function(a){if((!a||"timeupdate"!==a.type||a.slow)&&this.$els.length){a=this.ui.options;var b=this.isAtStart(),c=this.isAtEnd(),
d=this.ui.source.paused;rafer.call(this.$els,"toggleClass",replace("${classprefix}playpausestate-playing",a),!d);rafer.call(this.$els,"toggleClass",replace("${classprefix}playpausestate-paused",a),d);rafer.call(this.$els,"toggleClass",replace("${classprefix}playpausestate-start",a),b);rafer.call(this.$els,"toggleClass",replace("${classprefix}playpausestate-end",a),c);rafer.call(this.$els,"toggleClass",replace("${classprefix}playpausestate-middle",a),!c&&!b)}},isAtStart:function(){return 1>=Math.floor(this.ui.source.currentTime*
this.floorPrecision)},isAtEnd:function(){return 1>=Math.abs(Math.floor(this.ui.source.currentTime*this.floorPrecision)-Math.floor(this.ui.source.duration*this.floorPrecision))},destroy:function(){MediaUI.Output.prototype.destroy.apply(this,arguments);this.$els=this.ui=null}});MediaUI.Output.Resize=MediaUI.Output.extend({ui:null,el:null,constructor:function(a){MediaUI.Output.apply(this,arguments);if(this.el=a.$all().filterByAttribute(a.options.outputattribute,"resize")[0])this.ui=a,this.listenTo(this.ui.media,{resize:this.onResize})},onResize$bind:function(a){var b=this.getUIDimensions(),c=new Media.Class.Dimensions(this.ui.el.offsetParent||window);this.applyStyles(this.el,c,b[this.ui.fullscreen.isActive?"fullscreen":"normal"]);b=find(elements(this.ui.source).stack(),function(a){return a===
this.ui.el})?this.ui.el.offsetParent:this.ui.source.offsetParent;c=new Media.Class.Dimensions(b||window);this.applyStyles(this.ui.source,c,a[this.ui.fullscreen.isActive?"fullscreen":"normal"])},applyStyles:function(a,b,c){var d={"object-fit":"fill"};switch(c.width.unit){case "contain":c.ratio<=b.ratio?(d.height="100%",d.width=makeUnit(b.height.value*c.ratio,b.height.unit)):(d.width="100%",d.height=makeUnit(b.width.value/c.ratio,b.width.unit));break;case "cover":c.ratio<=b.ratio?(d.width="100%",d.height=
makeUnit(b.width.value/c.ratio,b.width.unit)):(d.height="100%",d.width=makeUnit(b.height.value*c.ratio,b.height.unit));break;case "retain":var e=clamp(0,b.height.value,a.videoHeight||a.originalHeight||a.height),f=clamp(0,b.width.value,a.videoWidth||a.originalWidth||a.width);c.ratio<=b.ratio?(d.height="100%",d.width=makeUnit(e*c.ratio,b.height.unit)):(d.width="100%",d.height=makeUnit(f/c.ratio,b.width.unit));break;case "fill":d.height="100%";d.width="100%";break;case "none":d.height="";d.width="";
break;default:"auto"!==c.width.unit&&(d.width=makeUnit(c.width.value,c.width.unit)),"auto"!==c.height.unit&&(d.height=makeUnit(c.height.value,c.height.unit)),"auto"===c.width.unit&&(d.width=makeUnit(b.height.value*c.ratio,"px")),"auto"===c.height.unit&&(d.height=makeUnit(b.width.value/c.ratio,"px"))}e=b=!1;f=["0","0"];var g=["","","",""];switch(c.x.keyword){case "center":e=b=!0;g[3]="50%";f[0]="-50%";break;case "left":b=!0;g[3]=c.x.value;break;case "right":b=!0,g[1]=c.x.value}switch(c.y.keyword){case "center":e=
b=!0;g[0]="50%";f[1]="-50%";break;case "top":b=!0;g[0]=c.y.value;break;case "bottom":b=!0,g[2]=c.y.value}d.position=b?"absolute":"";d.transform=e?"translate("+f.join(",")+")":"";d.top=g[0];d.right=g[1];d.bottom=g[2];d.left=g[3];for(var l in d)a.style[l]=d[l]},getUIDimensions:function(){var a=this.ui.options;return{fullscreen:new Media.Class.Dimensions(a.uifullscreensize,a.uifullscreenratio,a.uifullscreenposition),normal:new Media.Class.Dimensions(a.uisize,a.uiratio,a.uiposition)}},destroy:function(){MediaUI.Output.prototype.destroy.apply(this,
arguments);this.el=this.ui=null}});Media.DefaultOptions.add({uisize:function(){return this.mediasize},uiratio:function(){return this.mediaratio},uiposition:"none none",uifullscreensize:function(){return this.uisize},uifullscreenratio:function(){return this.uiratio},uifullscreenposition:function(){return this.uiposition}}); return exports;}));
//# sourceMappingURL=mediaui.min.js.map

