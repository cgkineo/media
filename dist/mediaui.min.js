(function(window, $){
var parseUnit=function(t,e,i){var n=(t=String(t||0)+String(e||"")).match(/[^0-9\.]+/g);return e=void 0===i?"px":i,n&&(e=n[0]),{value:parseFloat(t)||0,unit:e}},toggleClass=function(t,e,i){switch(typeof e){case"string":e=e.split(" ")}i=void 0===i||i;for(var n=t.classList,s=0,r=e.length;s<r;s++){for(var a=e[s],o=!1,u=0,l=n.length;u<l;u++)n[u]===a&&(o=!0);!o&&i?n.add(a):o&&!i&&n.remove(a)}0===t.classList.length&&removeAttribute(t,"class")},removeAttribute=function(t,e){return t.removeAttribute?t.removeAttribute(e):t.attributes.removeNamedItem&&t.attributes.getNamedItem(e)?t.attributes.removeNamedItem(e):void t.setAttribute(e,"")},removeElement=function(t){if(t.remove)return t.remove();t.parentNode.removeChild(t)},replaceWith=function(t,e){if(t.replaceWith)return t.replaceWith(e);for(var i=t.parentNode,n=0,s=i.childNodes.length;n<s;n++)if(i.childNodes[n]===t)return i.insertBefore(e,t),void removeElement(t)},prependElement=function(t,e){if(!t.childNodes.length)return t.appendChild(e);t.insertBefore(e,t.childNodes[0])},createEvent=function(t,e){if(e=defaults(e,{bubbles:!1,cancelable:!0}),!createEvent.t)try{return new Event(t,e)}catch(t){createEvent.t=!0}var i;if(createEvent.t)return(i=document.createEvent("Event")).initEvent(t,e.bubbles,e.cancelable),i},delay=function(t,e){setTimeout(t,e)},debounce=function(e,i){var n=null;return function(){var t=arguments;clearTimeout(n),n=setTimeout(function(){e.apply(this,t)}.bind(this),i||0)}},bindAll=function(t,e){var i=0,n=e;e instanceof Array||(n=arguments,i=1);var s={};for(var r in t)s[r]=!0;for(var a=i,o=n.length;a<o;a++){var u=n[a],l=Object.getOwnPropertyDescriptor(t,u);if(!l||l.writable){if(!(t[u]instanceof Function)){var c="Cannot bindAll to non-function '"+u+"'";throw console.log(c,t),c}var h=s[u];Object.defineProperty(t,u,{value:t[u].bind(t),enumerable:h,writable:!0,configurable:!0})}}},getUrl=function(t,e,i){var n=new XMLHttpRequest;n.addEventListener("load",function(t){e.call(i,t.target.responseText)}),n.open("GET",t),n.send()},postUrl=function(t,e,i,n){var s=new XMLHttpRequest;s.addEventListener("load",function(t){i.call(n,t.target.responseText)}),s.open("POST",t),s.send(e)},toArray=function(t,e){return t?Array.prototype.slice.call(t,e||0):[]},isArray=function(t){return"[object Array]"==Object.prototype.toString.call(t)},find=function(t,e){for(var i=0,n=t.length;i<n;i++)if(e)return t;return null},clamp=function(t,e,i){return e<t?t:i<e?i:e},isNumber=function(t){return"[object Number]"==Object.prototype.toString.call(t)},isObject=function(t){return"[object Object]"==Object.prototype.toString.call(t)},ObjectValues=function(t){var e=[];for(var i in t)e.push(t[i]);return e},extendNotEnumerable=function(t,e){for(var i=1,n=arguments.length;i<n;i++){var s=arguments[i];if(s){var r=Object.keys(s);for(i=0,n=r.length;i<n;i++){var a=r[i];Object.getOwnPropertyDescriptor(s,a).configurable&&Object.defineProperty(t,a,{configurable:!0,value:s[a],enumerable:!1,writable:!0})}}}return t},extend=function(t,e){t=t||{};for(var i=1,n=arguments.length;i<n;i++){var s=arguments[i];for(var r in s)t[r]=s[r]}return t},deepDefaults=function(t,e){t=t||{};for(var i=1,n=arguments.length;i<n;i++){var s=arguments[i];for(var r in s)t.hasOwnProperty(r)||(t[r]=s[r]),isObject(t[r])&&(t[r]=deepDefaults(t[r],s[r]))}return t},defaults=function(t,e){t=t||{};for(var i=1,n=arguments.length;i<n;i++){var s=arguments[i];for(var r in s)t.hasOwnProperty(r)||(t[r]=s[r])}return t},get=function(t,e){for(var i=e.split(/[\/\.\:]/g);"object"==typeof(t=t[i.shift()])&&null!==t&&i.length;);return t},set=function(t,e,i){var n,s=e.split(/[\/\.\:]/g);do{if(1===s.length)break;t[n=s.shift()]||(t[n]={}),t=t[n]}while("object"==typeof t&&null!==t);n=s.shift(),void 0===i?delete t[n]:t[n]=i},indexOfRegex=function(t,e,i){var n=(i=i||0)?t.substring(i):t,s=n.match(e);return s?n.indexOf(s[0])+i:-1},lastIndexOfRegex=function(t,e,i){var n=(i=i||0)?t.substring(0,i):t,s=n.match(e);return s?n.lastIndexOf(s[s.length-1]):-1},includes=function(t,e,i){return"number"!=typeof i&&(i=0),!("string"==typeof t&&i+e.length>t.length)&&-1!==t.indexOf(e,i)},replace=function(t,e,i){for(var n in i=i||{clean:!0},replace.cache=replace.cache||{},e){var s="\\$\\{"+n+"\\}",r=replace.cache[s]=replace.cache[s]||new RegExp("\\$\\{"+n+"\\}","gi");t=t.replace(r,e[n])}return i.clean&&(t=t.replace(/\$\{[^\}]+\}/g,"")),t},template=function(string,options){for(var regexStr=/\$\{[^\^\$}]*\}/,pieces=[];string.match(regexStr);){for(;string&&(match=string.match(regexStr));){var start=match.index;pieces.push(string.slice(0,start));var end=match.index+match[0].length,evaluate=string.slice(start+2,end-1);pieces.push(eval(evaluate)),string=string.slice(end)}pieces.push(string),string=pieces.join(""),pieces.length=0}return string},properties=function(t,e){var i=!!e;e=e||t;for(var n={},s=Object.getOwnPropertyNames(e),r=0,a=s.length;r<a;r++){var o,u,l=s[r],c=l.indexOf("$");if((-1!==c||i)&&(u=-1===c?(o="",l):(o=l.slice(c),l.slice(0,c)))){var h=o.split("$"),d=includes(h,"get"),f=includes(h,"set"),p=includes(h,"value"),v=includes(h,"enum"),m=includes(h,"write"),g=includes(h,"config"),M=0;if(M+=d?1:0,M+=f?1:0,1<(M+=p?1:0))throw"Cannot have two types in one definition.";M+=v?1:0,M+=m?1:0,M+=g?1:0;var b=n[u]=n[u]||{value:e[l]};p&&(b.value=e[l]),d&&(b.get=e[l]),f&&(b.set=e[l]),v&&(b.enumerable=!0),m&&(b.writable=!0),g&&(b.configurable=!0),b.value&&(b.get||b.set)&&delete b.value,delete e[l],delete t[u]}}return Object.keys(n).length&&Object.defineProperties(t,n),t},EventsInitialize=function(t){t.events&&t.trigger||(t.events||Object.defineProperty(t,"events",{value:new EventsRegistry,enumerable:!1,writable:!0}),t.trigger||Object.defineProperty(t,"trigger",{value:Events.trigger,enumerable:!1,writable:!0}))},EventsArgumentsNotation=function(t,e,i,n,s){if(t instanceof Object){var r=t;for(var a in i=i||s,r)for(var o=0,u=(c=a.split(" ")).length;o<u;o++){var l=c[o];e=r[a],n.call(s,l,e,i)}}else if("string"==typeof t){var c;for(i=i||s,o=0,u=(c=t.split(" ")).length;o<u;o++)l=c[o],n.call(s,l,e,i)}else if(void 0===t&&void 0===e&&void 0===i)return n.call(s,null,null,null)},EventsRegistry=function(){};EventsRegistry.prototype=new Array;var EventRegister=function(t){if(t.name){if(!t.callback)throw"Cannot find callback";EventsInitialize(t.from),EventsInitialize(t.to),this.from=t.from,this.to=t.to,this.context=t.context,this.name=t.name,this.callback=t.callback,this.once=t.once,this.from.events.push(this),this.from!==this.to&&this.to.events.push(this)}};EventRegister.prototype.destroy=function(){this.from.events=this.from.events.filter(function(t){return t!==this}.bind(this)),this.from!==this.to&&(this.to.events=this.to.events.filter(function(t){return t!==this}.bind(this)))};var Events={events:null,listenTo:function(t,e,i){EventsArgumentsNotation(e,i,t,function(t,e,i){new EventRegister({from:i,to:this,context:this,name:t,callback:e,once:!1})},this)},listenToOnce:function(t,e,i){EventsArgumentsNotation(e,i,t,function(t,e,i){new EventRegister({from:i,to:this,context:this,name:t,callback:e,once:!0})},this)},stopListening:function(t,e,i){EventsArgumentsNotation(e,i,t,function(t,e,i){if(this.events)for(var n=this.events.length-1;-1<n;n--){var s=this.events[n];s.to.events===this.events&&(null!==t&&s.name!==t||null!==e&&s.callback!==e||s.destroy())}},this)},on:function(t,e,i){EventsArgumentsNotation(t,e,i,function(t,e,i){new EventRegister({from:this,to:this,context:i,name:t,callback:e,once:!1})},this)},once:function(t,e,i){EventsArgumentsNotation(t,e,i,function(t,e,i){new EventRegister({from:this,to:this,context:i,name:t,callback:e,once:!0})},this)},off:function(t,e,i){EventsArgumentsNotation(t,e,i,function(t,e,i){if(this.events)for(var n=this.events.length-1;-1<n;n--){var s=this.events[n];s.from.events===this.events&&(null!==t&&s.name!==t||null!==e&&s.callback!==e||s.destroy())}},this)},trigger:function(t){EventsInitialize(this);var e=[];if(this.events){for(var i=0,n=this.events.length;i<n;i++)(s=this.events[i]).from.events===this.events&&("*"!==s.name&&s.name!==t||e.push(s));for(e.reverse(),i=e.length-1;-1<i;i--){var s;"*"===(s=e[i]).name?s.callback.apply(s.context,arguments):s.callback.apply(s.context,toArray(arguments,1)),s.once&&s.destroy()}}},destroy:function(){this.stopListening()}},ClassExtend=function(t,e,i){var n,s=this;return n=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return s.apply(this,arguments)},Object.defineProperty(n,"classOptions",{value:defaults(i,s.classOptions,{extendFunction:!0,inheritClassEnumerables:!1,classEvents:!1,classProperties:!0,instanceEvents:!1,instanceProperties:!0}),enumerable:!1,writable:!0}),n.prototype=Object.create(s.prototype),n.classOptions.extendFunction&&extendNotEnumerable(n,{extend:ClassExtend}),n.classOptions.classEvents&&extendNotEnumerable(n,Events),n.classOptions.inheritClassEnumerables&&extend(n,s),extend(n,e),n.classOptions.instanceEvents&&void 0===n.prototype.events&&extendNotEnumerable(n.prototype,Events),extend(n.prototype,t),n.classOptions.instanceProperties&&(Object.defineProperty(n.prototype,"defineProperties",{value:function(t){return properties(this,t)},enumerable:!1,writable:!1,configurable:!1}),properties(n.prototype)),n.classOptions.classProperties&&(Object.defineProperty(n,"defineProperties",{value:function(t){return properties(this,t)},enumerable:!1,writable:!1,configurable:!1}),properties(n)),extendNotEnumerable(n.prototype,{constructor:n}),n},ClassParent=function(t,e){},ListParent=function(t,e){};ListParent.prototype=new Array,Array.prototype.find||(List.prototype.find=function(t){for(var e=0,i=this.length;e<i;e++)if(t(this[e],e))return!0;return!1});var Class=ClassExtend.call(ClassParent,{constructor:function(){}},{},{classEvents:!1,instanceEvents:!1}),List=ClassExtend.call(ListParent,{constructor:function(){}},{},{classEvents:!1,instanceEvents:!1}),Elements=List.extend({subject:null,constructor:function(t,e){this.subject=e||document,this.add(t,this.subject),this.selector=t},filterByAttribute:function(n,s){var t=this.filter(function(t){var e=t.getAttribute(n);if(e){var i=e.split(" ");return!!includes(i,s)||void 0}});return new Elements(t)},filterByTypes:function(t){var i=t.split(",").map(function(t){return t.trim()}),e=this.filter(function(t){var e=t.tagName.toLowerCase();if(includes(i,e))return!0});return new Elements(e)},query:function(e){var i=new Elements;return this.forEach(function(t){i.push.apply(i,t.querySelectorAll(e))}),i},isHidden:function(){var t=this.stack();return Boolean(t.find(function(t){var e=window.getComputedStyle(t);return"hidden"==e.visibility||"none"==e.display||0==e.opacity}))},stack:function(e){var t=this.parents();return t.unshift(this[0]),e&&(t=t.filter(function(t){return t.matches(e)})),t},parents:function(e){for(var t=this[0],i=new Elements;(t=t.parentNode)&&i.add(t),t;);return e&&(i=i.filter(function(t){return t.matches(e)})),i},value:function(){return this[0].value},add:function(t,e){if(this.selector="",e=e||document,t instanceof HTMLElement)return this.push(t),this;if(t instanceof Array||t instanceof NodeList){for(var i=0,n=t.length;i<n;i++)this.add(t[i]);return this}if("string"!=typeof t)return this;var s=e.querySelectorAll(t);for(i=0,n=s.length;i<n;i++)this.push(s[i]);return this},clone:function(t){for(var e=[],i=0,n=this.length;i<n;i++)e.push(this[i].cloneNode(t));return new Elements(e,this.subject)},on:function(e,i,n){if((n=n||{}).passive=!1!==n.passive||n.passive,e instanceof Object){for(var t in e)this.on(t,e[t],i);return this}return this.forEach(function(t){t.addEventListener(e,i,n)}),this},off:function(e,i){if(e instanceof Object){for(var t in e)this.off(t,e[t]);return this}return this.forEach(function(t){t.removeEventListener(e,i)}),this},removeAttributes:function(t){return t||(t=this.attrs()),this.removeAttribute(t)},removeAttribute:function(e){if(e instanceof Object){for(var t in e)this.removeAttribute(t);return this}return this.forEach(function(t){removeAttribute(t,e)}),this},attrs:function(t){if(t)return this.attr(t);t={};for(var e=0,i=this[0].attributes.length;e<i;e++)t[this[0].attributes[e].name]=this[0].attributes[e].value;return t},attr:function(e,i){if(e instanceof Object){for(var t in e)this.attr(t,e[t]);return this}return this.forEach(function(t){t.setAttribute(e,i)}),this},toggleClass:function(e,i){return this.forEach(function(t){toggleClass(t,e,i)}),this}}),elements=function(t,e){return new Elements(t,e)};extend(elements,Elements);var Rafer=Class.extend({deferred:null,requests:null,isWaiting:!1,mode:"ram",ramLimit:50,currentDeferredLength:0,currentRequestsLength:0,constructor:function(){bindAll(this,"frame"),this.defineProperties({deferred$write:new Array(100),requests$write:new Array(100),currentDeferredLength$write:0,currentRequestsLength$write:0,isWaiting$write:!1})},resizeDeferred$write:function(){var t=2*this.deferred.length;this.deferred.length=t},resizeRequests$write:function(){var t=2*this.requests.length;this.requests.length=t},set:function(t,e,i){this.isWaiting||this.request(this.dummy),this.currentDeferredLength===this.deferred.length-1&&this.resizeDeferred();var n={subject:t,name:e,value:i,type:"set"};this.deferred[this.currentDeferredLength]=n,this.currentDeferredLength++},get:function(t,e){for(var i=0,n=this.currentDeferredLength;i<n;i++){var s=this.deferred[i];if(s.subject===t&&s.name===e)return s.value}return t[e]},call:function(t,e,i){this.isWaiting||this.request(this.dummy),this.currentDeferredLength===this.deferred.length-1&&this.resizeDeferred();var n={order:0,subject:t,name:e,value:toArray(arguments,2),type:"call"};this.deferred[this.currentDeferredLength]=n,this.currentDeferredLength++},callLast:function(t,e,i){this.isWaiting||this.request(this.dummy),this.currentDeferredLength===this.deferred.length-1&&this.resizeDeferred();var n={order:1,subject:t,name:e,value:toArray(arguments,2),type:"call"};this.deferred[this.currentDeferredLength]=n,this.currentDeferredLength++},dummy$write:function(){},flush$write:function(){var t=0;do{for(var e=[],i=this.currentDeferredLength,n=0,s=i;n<s;n++)e.push(this.deferred[n]),this.deferred[n]=null;for(e.sort(function(t,e){return e.order-t.order}),n=this.currentDeferredLength=0,s=i;n<s;n++){var r=e[n];try{switch(r.type){case"set":r.subject[r.name]=r.value;break;case"call":r.name||"function"!=typeof r.subject?r.subject||"function"!=typeof r.name?r.subject[r.name].apply(r.subject,r.value):r.name.apply(r.subject,r.value):r.subject.apply(r.name,r.value)}}catch(t){}}this.currentDeferredLength&&t++}while("ram"===this.mode&&0!==this.currentDeferredLength&&t<this.ramLimit);t===this.ramLimit&&(this.mode="wait",console.log("Deferred queue modified by queue, switching to wait mode."))},request:function(t,e){!t||t.e&&!e||(this.currentRequestsLength===this.requests.length&&this.resizeRequests(),(this.requests[this.currentRequestsLength]=t).e=this.currentRequestsLength+1,this.currentRequestsLength++),this.currentRequestsLength&&(this.isWaiting||(this.isWaiting=!0,window.requestAnimationFrame(this.frame)))},frame$write:function(){for(var t=[],e=this.currentRequestsLength,i=0,n=e;i<n;i++)t.push(this.requests[i]),this.requests[i]=null;for(i=this.currentRequestsLength=0,n=e;i<n;i++)t[i].e=null,t[i](),t[i]=null;this.isWaiting=!1,this.flush(),this.request()}}),rafer=new Rafer,Media=Class.extend({el:null,options:null,constructor:function t(e,i){if(e[t.propName])return e;this.defineProperties({proxyEvent$write:this.proxyEvent.bind(this)}),this.el=e,(this.el[t.propName]=this).options=i||{},this.options instanceof t.DefaultOptions||(this.options=new t.DefaultOptions(this.options)),this.options.add({media:this,id:this.el.id}),this.initialize()},initialize:function(){Media.players.push(this),Media.trigger("create",this),this.trigger("create"),this.attachEvents(),delay(function(){Media.trigger("created",this),this.trigger("created"),this.checkPlaying()}.bind(this),1)},checkPlaying$write:function(){this.el.paused||this.dispatchEvent("play")},attachEvents$write:function(){for(var t=0,e=Media.DOMEvents.length;t<e;t++)this.el.addEventListener(Media.DOMEvents[t],this.proxyEvent)},dispatchEvent:function(t,e){"timeupdate"===t&&(e=defaults(e,{fast:!0,medium:!0,slow:!0}));var i=createEvent(t,e);i.fake=!0,extend(i,e),this.el.dispatchEvent(i)},proxyEvent$write:function(t){!t.fake&&"timeupdate"===t.type||(!t.fake&&"resize"===t.type||this.trigger(t.type,t),Media.trigger(t.type,this,t))},destroy:function(){Media.trigger("destroy",this),this.trigger("destroy");for(var t=Media.players.length-1;-1<t;t--)Media.players[t]===this&&Media.players.splice(t,1);this.detachEvents(),this.selector=null,this.options=null,delay(function(){delete this.el[Media.propName],this.el=null,Media.trigger("destroyed",this),this.trigger("destroyed")}.bind(this),1)},detachEvents$write:function(){for(var t=0,e=Media.DOMEvents.length;t<e;t++)this.el.removeEventListener(Media.DOMEvents[t],this.proxyEvent)}},{supportedTags$enum$write:"video, audio, canvas, img",propName$enum$write:"player",Class$write:Class.extend({constructor:function(){}},{List:List.extend({constructor:function(){}},null,{instanceEvents:!0})},{instanceEvents:!0})},{classEvents:!0,instanceEvents:!0});window.Media=Media,Media.DefaultOptions=Class.extend({constructor:function(t){this.add(t)},add$write:function(t){extend(this,t)},get$write:function(t){return this[t]},toJSON$write:function(){var t={};for(var e in this)t[e]=this[e];return t}},{add$write$enum:function(t){var e=function(e,t){Object.defineProperty(this.prototype,e,{enumerable:!0,get:function(){return"function"==typeof this["_"+e]?this["_"+e]():this["_"+e]},set:function(t){this.hasOwnProperty("_"+e)||Object.defineProperty(this,"_"+e,{enumerable:!1,writable:!0,value:null}),this["_"+e]=t}}),this.prototype[e]=t}.bind(this);for(var i in t)e(i,t[i])},get$write$enum:function(t){return this.prototype[t]},toJSON$write$enum:function(){var t={};for(var e in this.prototype)t[e]=this.prototype[e];return t}},{inheritClassEnumerables:!0}),Media.DefaultOptions.add({id:"",media:null}),Media.Class.DOMEvents=Media.Class.List.extend({constructor:function(){},add:function(t){return t instanceof Array?this.push.apply(this,t):this.push(t)}}),Media.defineProperties({DOMEvents$write:new Media.Class.DOMEvents}),Media.DOMEvents.add(["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","process","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"]),Media.Class.Device=Media.Class.extend({isUsingTouch:!1,lastTouch:null,constructor:function(){this.checkTouchDevice()},isIOS$get$enum:function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&!window.MSStream},wasTouchedRecently$get$enum:function(){return Date.now()-this.lastTouch<600},checkTouchDevice$write:function(){var t=function(){this.lastTouch=Date.now(),this.isUsingTouch=!0}.bind(this);window.addEventListener("touchstart",t,{capture:!0,passive:!0}),window.addEventListener("touchend",t,{capture:!0,passive:!0})}}),Media.defineProperties({device$enum:new Media.Class.Device});var MediaUIComponent=Class.extend({constructor:function(t){this.listenTo(t.media,{destroyed:function(){this.destroy()}})}},null,{instanceEvents:!0}),MediaUIController=MediaUIComponent.extend({constructor:function(){MediaUIComponent.apply(this,arguments)}}),MediaUIInput=MediaUIComponent.extend({constructor:function(){MediaUIComponent.apply(this,arguments)}}),MediaUIOutput=MediaUIComponent.extend({constructor:function(){MediaUIComponent.apply(this,arguments)}}),MediaUIList=List.extend({constructor:function(){},add:function(e){this.find(function(t){return e===t})||this.push(e)},remove:function(t){for(var e=-1,i=0,n=this.length;i<n;i++)if(t===this[i]){e=i;break}-1!==e&&this.splice(e,1)}});!function(){var e=!1,a=function(t){t=t||{};for(var e=1,i=arguments.length;e<i;e++){var n=arguments[e];for(var s in n)t.hasOwnProperty(s)||(t[s]=n[s]),r=t[s],"[object Object]"==Object.prototype.toString.call(r)&&(t[s]=a(t[s],n[s]))}var r;return t},s=function(t){if(!s.t)try{return new Event(t)}catch(t){s.t=!0}var e;if(s.t)return(e=document.createEvent("Event")).initEvent(t,!0,!0),e},o={fullscreenElement:null,exitFullscreen:null,requestFullscreen:null,fullscreenEnabled:null,onfullscreenchange:null,onfullscreenerror:null},u={fullscreenElement:["webkitFullscreenElement","mozFullScreenElement","msFullscreenElement"],exitFullscreen:["webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"],requestFullscreen:["webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen"],fullscreenEnabled:["webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled"],onfullscreenchange:["onwebkitfullscreenchange","onmozfullscreenchange","onmsfullscreenchange"],onfullscreenerror:["onwebkitfullscreenerror","onmozfullscreenerror","onmsfullscreenerror"],fullscreenchange:["webkitfullscreenchange","mozfullscreenchange","msfullscreenchange"],fullscreenerror:["webkitfullscreenerror","mozfullscreenerror","msfullscreenerror"]},r=!1,l=!0,c=!0,t=function(t,e,i){if(void 0===t[e]){for(var n=0,s=u[e].length;n<s;n++){var r=u[e][n];if(void 0!==t[r])return l=!1,void(o[e]=r)}c=l=!1,o[e]=null}else o[e]=e},i=!1,n=null,h=!1,d={fullscreenElement:!1,fullscreenEnabled:!1,exitFullscreen:!1,requestFullscreen:!1,onfullscreenchange:!1,onfullscreenerror:!1};function f(t){27===t.keyCode&&n&&i&&document.exitFullscreen()}document.addEventListener("fullscreenchange",function(t){document.fullscreenElement&&h&&(h=!1),e&&console.log("fullscreenchange",document.fullscreenElement,t)}),document.addEventListener("fullscreenerror",function(t){h=!1,e&&console.log("fullscreenerror",document.fullscreenElement,t),i=!0,document.exitFullscreen&&document.exitFullscreen()}),t(document,"fullscreenElement"),t(document,"exitFullscreen"),t(Element.prototype,"requestFullscreen"),t(document,"fullscreenEnabled"),t(document,"onfullscreenchange"),t(document,"onfullscreenerror"),function(){if(!r){r=!0;for(var t=function(t){t=a(s("fullscreenchange"),t),document.dispatchEvent(t)},e=function(t){t=a(s("fullscreenerror"),t),document.dispatchEvent(t)},i=0,n=u.onfullscreenchange.length;i<n;i++)void 0!==document[u.onfullscreenchange[i]]&&(document[u.onfullscreenchange[i]]=t);for(i=0,n=u.onfullscreenerror.length;i<n;i++)void 0!==document[u.onfullscreenerror[i]]&&(document[u.onfullscreenerror[i]]=e)}}(),d.fullscreenElement||(d.fullscreenElement=!0,Object.defineProperty(document,"fullscreenElement",{get:function(){return i?(e&&console.log("get fullscreenElement",n),n):(e&&console.log("get fullscreenElement",document[o.fullscreenElement]),document[o.fullscreenElement])}})),d.fullscreenEnabled||(d.fullscreenEnabled=!0,Object.defineProperty(document,"fullscreenEnabled",{get:function(){return i?(e&&console.log("get fullscreenEnabled",!0),!0):(e&&console.log("get fullscreenEnabled",document[o.fullscreenEnabled]),document[o.fullscreenEnabled])}})),d.exitFullscreen||(d.exitFullscreen=!0,document.exitFullscreen=function(){return e&&console.log("exitFullscreen"),i?(n=null,void document.dispatchEvent(s("fullscreenchange"))):document[o.exitFullscreen].apply(this,arguments)}),d.requestFullscreen||(d.requestFullscreen=!0,Element.prototype.requestFullscreen=function(){return h=!0,e&&console.log("requestFullscreen",this),i?(n=this,void document.dispatchEvent(s("fullscreenchange"))):this[o.requestFullscreen].apply(this,arguments)}),d.onfullscreenchange||(d.onfullscreenchange=!0,Object.defineProperty(document,"onfullscreenchange",{get:function(){return e&&console.log("get onfullscreenchange",document[o.onfullscreenchange]),document[o.onfullscreenchange]},set:function(t){e&&console.log("set onfullscreenchange",document[o.onfullscreenchange]),document[o.onfullscreenchange]=t}})),d.onfullscreenerror||(d.onfullscreenerror=!0,Object.defineProperty(document,"onfullscreenerror",{get:function(){return e&&console.log("get onfullscreenerror",document[o.onfullscreenerror]),document[o.onfullscreenerror]},set:function(t){e&&console.log("set onfullscreenerror",document[o.onfullscreenerror]),document[o.onfullscreenerror]=t}})),window.removeEventListener("keyup",f),window.addEventListener("keyup",f),i=!document.fullscreenEnabled,window.fullscreenPolyfill={},Object.defineProperties(window.fullscreenPolyfill,{useFullWindow:{get:function(){return i},set:function(t){i=t},enumerable:!0},api:{get:function(){return o},enumerable:!0},applied:{get:function(){return d},enumerable:!0},debug:{get:function(){return e},set:function(t){e=t}}}),c?l?console.log("Fullscreen API (from perfect API)."):console.log("Fullscreen API (from partially implemented API)."):console.log("Fullscreen API (from broken API).")}();var MediaUI=Class.extend({media$write:null,options$write:null,source$write:null,$source$write:null,el$write:null,$el$write:null,inputs:null,outputs:null,constructor:function(t,e){if(!e.uienabled)return this.destroy();this.media=t,this.media.ui=this.media.ui||new MediaUIList,this.media.ui.add(this),this.options=e||{},this.options instanceof Media.DefaultOptions||(this.options=new Media.DefaultOptions(e)),this.options.add({ui:this}),this.source=t.el,this.$source=elements(t.el),this.inputs={},this.outputs={},this.ensureElement(),this.processOptions(),this.startControllers(),this.startOutputs(),this.startInputs(),this.listenTo(t,{destroyed:this.onDestroyed}),this.trigger("ready")},$:function(t){return this.$el.query(t)},$all:function(){var t=this.$("*");return t.unshift(this.el),t},ensureElement$write:function(){this.el=this.options.el||this.getRenderedTemplate(),this.$el=elements(this.el)},getRenderedTemplate$write:function(){var t=this.options.uitemplate;if(t){var e=document.createElement("div");return e.innerHTML=t,e.children[0]}},processOptions$write:function(){if(this.originalAttributes=this.$source.attrs(),this.options.uireplace){var t=this.$("*").filterByAttribute(this.options.outputattribute,"mediaseat")[0];replaceWith(this.source,this.el),prependElement(t,this.source)}this.options.videoplaysinline&&"VIDEO"===this.source.tagName&&this.source.setAttribute("playsinline",!0)},startControllers$write:function(){for(var t in MediaUI.Controller){var e=MediaUI.Controller[t];e.prototype instanceof MediaUI.Controller&&(this[t.toLowerCase()]=new e(this))}},startInputs$write:function(){for(var t in MediaUI.Input){var e=MediaUI.Input[t];e.prototype instanceof MediaUI.Input&&(this.inputs[t.toLowerCase()]=new e(this))}},startOutputs$write:function(){for(var t in MediaUI.Output){var e=MediaUI.Output[t];e.prototype instanceof MediaUI.Output&&(this.outputs[t.toLowerCase()]=new e(this))}},unprocessOptions$write:function(){this.options.uireplace&&replaceWith(this.el,this.source),this.$source.attrs(this.originalAttributes)},onDestroyed:function(){this.unprocessOptions(),this.media.ui.remove(this),this.media=null,this.options=null,this.source=null,this.$source=null,this.el=null,this.$el=null,this.inputs=null,this.outputs=null,this.destroy()}},{Input$write:MediaUIInput,Output$write:MediaUIOutput,Controller$write:MediaUIController},{instanceEvents:!0});Media.DefaultOptions.add({videoplaysinline:!1,classprefix:"media--",outputattribute:"data-media-output",inputattribute:"data-media-input",ui:null,uienable:!1,uienablecaptions:!0,uienableposter:!0,uienablewaiting:!0,uienableskip:!0,uienablecontrols:!0,uienablebigplaypause:!0,uienablecontrolsbar:!0,uienablelittleplaypause:!0,uienablerailduration:!0,uienablerailback:!0,uienablerailbuffered:!0,uienablerailcurrent:!0,uienablelittlecaptions:!0,uienablelittlefullscreen:!0,uireplace:!1,uitemplate:function(){return template('<div class="${options.classprefix}main" ${options.outputattribute}="resizestate playpausestate captionsstate volumestate waitingstate posterstate engagestate">  <div class="${options.classprefix}resizecontainer" ${options.outputattribute}="resize mediaseat">    ${options.uienablecaptions && \'<div class="${options.classprefix}captions" ${options.outputattribute}="captions"></div>\'}    ${options.uienableposter && \'<div class="${options.classprefix}poster" ${options.outputattribute}="poster"></div>\'}    ${options.uienablewaiting && \'<div class="${options.classprefix}waiting"></div>\'}    ${options.uienableskip && \'<div class="${options.classprefix}skip" ${options.outputattribute}="skipnotification"></div>\'}'+(this.uienablecontrols&&'<div class="${options.classprefix}controls" ${options.outputattribute}="controlsstate" ${options.inputattribute}="taps skip toggleplaypause:notouch">      ${options.uienablebigplaypause && \'<button class="${options.classprefix}bigplaypause" ${options.outputattribute}="playpausearia" ${options.inputattribute}="toggleplaypause engage" aria-hidden="true"></button>\'}'+(this.uienablecontrolsbar&&'<div class="${options.classprefix}controlsbar" ${options.inputattribute}="engage stoptappropagation">        ${options.uienablelittleplaypause && \'<button class="${options.classprefix}littleplaypause" ${options.inputattribute}="toggleplaypause" ${options.outputattribute}="playpausearia"></button>\'}'+(this.uienablerailduration?'<div class="${options.classprefix}railduration" ${options.inputattribute}="scrubcurrenttime">          ${options.uienablerailback && \'<div class="${options.classprefix}railback"></div>\'}          ${options.uienablerailbuffered && \'<div class="${options.classprefix}railbuffered" ${options.outputattribute}="bufferedwidth"></div>\'}          ${options.uienablerailcurrent && \'<div class="${options.classprefix}railcurrent" ${options.outputattribute}="currenttimewidth"></div>\'}        </div>':"")+'${options.uienablelittlemute && \'<button class="${options.classprefix}littlemute" ${options.outputattribute}="mutearia" ${options.inputattribute}="togglemute"></button>\'}        ${options.uienablelittlecaptions && \'<button class="${options.classprefix}littlecaptions" ${options.outputattribute}="captionsaria" ${options.inputattribute}="togglecaptions"></button>\'}        ${options.uienablelittlefullscreen && \'<button class="${options.classprefix}littlefullscreen" ${options.outputattribute}="fullscreenaria" ${options.inputattribute}="togglefullscreen"></button>\'}      </div>'||"")+"</div>"||"")+"</div></div>",this)}}),$&&$.fn&&(Media.JQueryDefaultOptions=Media.DefaultOptions.extend({constructor:function(){Media.DefaultOptions.prototype.constructor.apply(this,arguments)}}),Media.JQueryDefaultOptions.add({uienabled:!0,uireplace:!0}),$.fn.medias=function(n){var t=this.find(Media.supportedTags);switch(t=t.add(this.filter(Media.supportedTags)),n){case"destroy":return t.each(function(t,e){e[Media.propName]instanceof Media&&e[Media.propName].destroy()}),t}return t.each(function(t,e){if(!e[Media.i]){n=new Media.JQueryDefaultOptions(n);var i=new Media(e,n);new MediaUI(i,n)}}),t},$.fn.play=function(){var t=this.find(Media.supportedTags);(t=t.add(Media.supportedTags)).each(function(t,e){e.play&&e.play()})},$.fn.pause=function(){var t=this.find(Media.supportedTags);(t=t.add(this.filter(Media.supportedTags))).each(function(t,e){e.pause&&e.pause()})}),Media.Class.Dimensions=Media.Class.extend({n:"contain",s:"16/9",r:"top left",width:parseUnit(0,"px"),height:parseUnit(0,"px"),ratio:16/9,x:parseUnit(0,"px"),y:parseUnit(0,"px"),constructor:function(t,e,i){if(t instanceof HTMLElement){var n=t.getBoundingClientRect();return this.width=parseUnit(n.width,"px"),this.height=parseUnit(n.height,"px"),void(this.ratio=n.width/n.height)}if(t===window)return this.width=parseUnit(window.innerWidth,"px"),this.height=parseUnit(window.innerHeight,"px"),void(this.ratio=this.width.value/this.height.value);this.size=void 0===t?this.a:t,this.aspect=void 0===e?this.o:e,this.position=void 0===i?this.u:i},size$set$snum:function(t){var e=(t=(this.a=t).trim()).split(" "),i=parseUnit(e[0]||"none"),n=parseUnit(e[1]||"none");switch(n.unit){case"auto":case"none":n.value=n.unit;break;case"contain":case"cover":case"fill":case"retain":i.value=n.value=n.unit=i.unit}switch(i.unit){case"auto":case"none":i.value=i.unit;break;case"contain":case"cover":case"fill":case"retain":i.value=n.value=n.unit=i.unit}this.width=i,this.height=n},size$get$enum:function(){return this.a},aspect$set$enum:function(t){var e=(t=(t=(t=(t=(this.o=t).trim()).replace(/\:/g," ")).replace(/\//g," ")).replace(/\*/g,"")).split(" "),i=parseUnit(e[0]||"none"),n=parseUnit(e[1]||"none");this.ratio=i.value/n.value},aspect$get$enum:function(){return this.o},position$set$enum:function(t){var e=new Array(4),i=(t=t.trim()).split(" ");switch(i.length){case 1:switch(i[0]){case"center":case"none":e[0]=i[0],e[1]=0,e[2]=i[0],e[3]=0;break;case"left":case"top":case"bottom":e[0]=i[0],e[1]=0,e[2]="none",e[3]=0;break;default:e[0]="left",e[1]=i[0],e[2]="top",e[3]="50%"}break;case 2:switch(i[0]){case"left":case"top":case"bottom":case"center":case"none":e[0]=i[0],e[1]=0;break;default:e[0]="auto",e[1]=i[0]}switch(i[1]){case"left":case"top":case"bottom":case"center":case"none":e[2]=i[0],e[3]=0;break;default:e[2]="auto",e[3]=i[0]}break;case 3:throw"Unable to process a 3 part position '"+t+"'";case 4:e=i}switch(e[0]){case"auto":switch(e[2]){case"auto":case"top":case"bottom":e[0]="left";break;case"left":case"right":e[0]="top"}}switch(e[2]){case"auto":switch(e[0]){case"auto":case"top":case"bottom":e[2]="left";break;case"left":case"right":e[2]="top"}}switch(e[2]){case"left":case"right":var n=e[0],s=e[1];e[0]=e[2],e[1]=e[3],e[2]=n,e[3]=s}this.x={keyword:e[0],value:e[1]},this.y={keyword:e[2],value:e[3]}},position$get$enum:function(){return this.u}}),Media.Class.Ended=Media.Class.extend({floorPrecision:10,constructor:function(){this.listenTo(Media,{created:this.onCreated,play:this.onPlay,pause:this.onPause,ended:this.onEnded})},onCreated:function(t){t.defineProperties({hasFiredEnded$write:!1})},onPlay:function(t){t.hasFiredEnded=!1},onPause:function(t){this.isEnded(t)&&!t.isAtEnd&&setTimeout(function(){t.el&&(t.hasFiredEnded||this.isEnded(t)&&t.el.dispatchEvent(createEvent("ended")))}.bind(this),150)},onEnded:function(t){t.hasFiredEnded=!0},isEnded:function(t){return Math.abs(Math.floor(t.el.currentTime*this.floorPrecision)-Math.floor(t.el.duration*this.floorPrecision))<=1}}),Media.defineProperties({ended:new Media.Class.Ended}),Media.Class.PauseOnPlay=Media.Class.extend({constructor:function(){this.listenTo(Media,{created:this.onCreated,play:this.onPlay})},onCreated:function(t){t.defineProperties({pauseonplay$enum$write:t.options.pauseonplay})},onPlay:function(t){for(var e=0,i=Media.players;e<i;e++){var n=Media.players[e];n.pauseonplay&&n.el.pause()}}}),Media.defineProperties({pauseonplay:new Media.Class.PauseOnPlay}),Media.DefaultOptions.add({pauseonplay:!1}),Media.Class.Players=Media.Class.List.extend({constructor:function(){List.apply(this,arguments)},findById:function(t){for(var e=0,i=this.length;e<i;e++){var n=this[e];if(n.el&&n.el.id===t)return n}return null},findByElement:function(t){for(var e=0,i=this.length;e<i;e++){var n=this[e];if(n.el&&n.el.id===t)return n}return null}}),Media.defineProperties({players$enum$write:new Media.Class.Players}),Media.Class.Resize=Media.Class.extend({constructor:function(t){bindAll(this,"onWindowResize","onFullScreenChanged"),this.listenTo(Media,{created:this.onCreated,resize:this.onResize}),this.addEventListeners()},addEventListeners$write:function(){window.removeEventListener("resize",this.onWindowResize),window.addEventListener("resize",this.onWindowResize),document.addEventListener("fullscreenchange",this.onFullScreenChanged)},onCreated:function(t){this.triggerMediaResize(t)},onFullScreenChanged$write:function(){this.resizeAllPlayers()},onResize:function(t,e){e.fake||this.resizeAllPlayers()},onWindowResize$write:function(){this.resizeAllPlayers()},resizeAllPlayers$write:function(){for(var t=0,e=Media.players.length;t<e;t++){var i=Media.players[t];this.triggerMediaResize(i)}},triggerMediaResize:function(t){var e=t.options;t.dispatchEvent("resize",{fullscreen:new Media.Class.Dimensions(e.mediafullscreensize,e.mediafullscreenratio,e.mediafullscreenposition),normal:new Media.Class.Dimensions(e.mediasize,e.mediaratio,e.mediaposition)}),t.dispatchEvent("postresize",{fullscreen:new Media.Class.Dimensions(e.mediafullscreensize,e.mediafullscreenratio,e.mediafullscreenposition),normal:new Media.Class.Dimensions(e.mediasize,e.mediaratio,e.mediaposition)})},removeEventListeners$write:function(){window.removeEventListener("resize",this.onWindowResize),document.removeEventListener("fullscreenchange",this.onFullScreenChanged)}}),Media.defineProperties({resize$write:new Media.Class.Resize}),Media.DOMEvents.add(["resize","postresize"]),Media.DefaultOptions.add({mediasize:"contain",mediaratio:"16/9",mediaposition:"none none",mediafullscreensize:function(){return this.mediasize},mediafullscreenratio:function(){return this.mediaratio},mediafullscreenposition:function(){return this.mediaposition}}),Media.Class.TextTrack=Media.Class.extend({activeCues:null,cues:null,readyState:0,label:null,kind:null,language:null,el:null,media:null,mode:"hidden",l:!1,default$get$enum:function(){return this.l},default$set$enum:function(t){if(this.l!==t){this.l=t,this.trigger("change",!0),this.media.dispatchEvent("texttrackchange",{track:this});for(var e=0,i=this.activeCues.length;e<i;e++)this.activeCues[e].isLive=!1;this.activeCues.length=0}},constructor:function(t,e){this.cues=[],this.activeCues=[],this.el=e,this.defineProperties({media$write:t}),this.default=null!==this.el.getAttribute("default"),this.language=this.el.getAttribute("srclang"),this.label=this.el.getAttribute("label"),this.kind=this.el.getAttribute("kind"),this.c=this.el.mode,this.el.mode="disabled",this.fetch()},addCue:function(t){for(var e=this.cues.length-1;-1<e;e--){var i=this.cues[e];if(i===t||i.id===t.id)return}this.cues.push(t)},removeCue:function(t){for(var e=this.cues.length-1;-1<e;e--){var i=this.cues[e];i!==t&&i.id!==t.id||this.cues.splice(e,1)}},update$write:function(){if(this.default){var e=this.media.el.currentTime,t=this.cues.filter(function(t){return t.startTime<=e&&t.endTime>=e&&!t.isLive}),i=this.activeCues.filter(function(t){return(t.startTime>e||t.endTime<e)&&t.isLive});0===t.length&&0===i.length||(i.forEach(function(t){t.isLive=!1}),this.activeCues=this.activeCues.filter(function(t){return!(t.startTime>e||t.endTime<e)}),this.activeCues.push.apply(this.activeCues,t),t.forEach(function(t){t.isLive=!0}),this.media.dispatchEvent("cuechange",{track:this,media:this}))}},fetch$write:function(){this.readyState=Media.Class.TextTrack.READYSTATE.LOADING,getUrl(this.el.src,function(t){t?(this.parse(t)?this.readyState=Media.Class.TextTrack.READYSTATE.LOADED:this.readyState=Media.Class.TextTrack.READYSTATE.ERROR,this.trigger("load",this)):this.readyState=Media.Class.TextTrack.h.ERROR},this)},parse$write:function(t){for(var e=-1<t.indexOf("\r\n")?"\r\n":"\n",i=t.split(e),n=[],s=[],r=0,a=i.length;r<a;r++){var o=i[r],u=r===i.length-1,l=!o;if(u&&!l&&s.push(o),(u||l)&&s.length){if(-1<s[0].toLowerCase().indexOf("webvtt")&&(s.splice(0,1),!s.length))continue;n.push({title:null,lines:s}),s=[]}else l||s.push(o)}try{for(r=0,a=n.length;r<a;r++)if(0!==(s=n[r]).lines[0].indexOf("NOTE"))if(0===s.lines[0].indexOf("STYLE"))console.log("Media does not support STYLE lines in WebVTT yet. Please leave an issue if needed.");else{if(-1===s.lines[0].indexOf("--\x3e")&&(s.title=s.lines[0],s.lines.shift()),-1===s.lines[0].indexOf("--\x3e")){this.readyState=Media.Class.TextTrack.READYSTATE.ERROR;break}extend(s,this.parseTimePlacement(s.lines[0])),s.lines.shift();var c=new Media.Class.TextTrackCue(s.startTime,s.endTime,s.lines.join("\n"));c.defineProperties({track$write:this}),c.lineAlign=s.align,c.line=s.line,c.position=s.position,c.size=s.size,c.vertical=s.vertical,this.addCue(c)}}catch(t){return console.log(t),!1}return!0},parseTimePlacement$write:function(t){if(t=t.trim(),-1===(i=indexOfRegex(t,/-->/)))throw"Time declaration error, no --\x3e";var e=t.slice(0,i).trim();t=t.slice(i);var i,n=indexOfRegex(t,/[0-9]+/);if(-1===n)throw"Time declaration error, no end time";t=t.slice(n),-1===(i=indexOfRegex(t,/[ ]{1}/))&&(i=t.length);var s=t.slice(0,i).trim();return t=t.slice(i),extend({startTime:this.parseTime(e),endTime:this.parseTime(s)},this.parsePlacement(t))},timeUnits$write:[.001,1,60,360],parseTime$write:function(t){var e=t.split(/[\:\.\,]{1}/g).reverse();if(e.length<3)throw"Time declaration error, mm:ss.ttt or hh:mm:ss.tt";for(var i=0,n=0,s=e.length;n<s;n++)i+=this.timeUnits[n]*parseInt(e[n]);return i},parsePlacement$write:function(t){var e=t.split(" ").filter(function(t){return t}),s={line:-1,position:"50%",size:"100%",align:"middle"};for(var i in e.forEach(function(t){var e=t.split(":"),i=e[1].split(","),n=e[0].toLowerCase();switch(n){case"d":n="vertical";break;case"l":n="line";break;case"t":n="position";break;case"s":n="size";break;case"a":n="align";break;case"vertical":case"line":case"position":case"size":case"align":break;default:throw"Bad position declaration, "+n}s[n]=i[0]||s[n]}),s.vertical="vertical"===s.vertical?"rl":"vertical-lr"===s.vertical?"lr":"horizontal",s){var n=s[i];switch(i){case"line":n=String(n||-1);break;case"position":n=String(n||"0%");break;case"size":n=String(n||"100%");break;case"align":switch(n=String(n||"middle")){case"start":case"middle":case"end":break;default:throw"Invalid align declaration"}}}return s},destroy:function(){for(var t=0,e=this.cues.length;t<e;t++)this.cues[t].destroy();this.el.mode=this.c,this.cues.length=0,this.activeCues.length=0,this.media=null,this.el=null,this.stopListening()}},{READYSTATE:{NONE:0,LOADING:1,LOADED:2,ERROR:3}}),Media.DOMEvents.add(["texttrackchange","cuechange"]),Media.Class.TextTrackCue=Media.Class.extend({region:null,id:null,startTime:null,endTime:null,vertical:null,snapToLines:null,line:null,lineAlign:null,position:null,positionAlign:null,size:null,textAlign:null,text:null,track$write:null,d:!1,isLive$get$enum:function(){return this.f},isLive$set$enum:function(t){var e;!this.f&&t?e="enter":this.f&&!t&&(e="exit"),e&&(this.f=t,this.trigger(e,this),this.track.media.dispatchEvent("cue"+e,{cue:this}))},constructor:function(t,e,i){this.id="cue-"+ ++Media.Class.TextTrackCue.id,this.startTime=t,this.endTime=e,this.text=i,this.defineProperties({d:!1,track$write:!1})},getCueAsHTML:function(){var t=this.track.media.options.classprefix,e=document.createElement("span"),i={id:this.id,lang:this.track.language,class:t+"cue",style:""};for(var n in this.renderCuePlacement(i,this),i)e.setAttribute(n,i[n]);var s=document.createElement("span");return s.setAttribute("class",t+"cue-text"),s.innerHTML='<span class="'+t+'cue-line">'+this.text.replace(/\n/g,'</span><br><span class="'+t+'cue-line">')+"</span>",e.appendChild(s),e},renderCuePlacement$write:function(t,e){var i=this.track.media.options.classprefix,n=t.class.split(" ");n.push(i+"cue-"+e.vertical);var s="position: absolute;";switch(e.vertical){case"horizontal":switch(s+="transform: translateX(-50%);",e.lineAlign){case"start":s+="text-align: left;",n.push(i+"cue-align-left");break;case"middle":s+="text-align: center;",n.push(i+"cue-align-center");break;case"end":s+="text-align: right;",n.push(i+"cue-align-right")}s+="width:"+e.size+";",s+="left:"+e.position+";",-1<String(e.line).indexOf("%")||0<=e.line?(e.line,s+="top:"+e.line+"%"):s+="bottom:"+(100-100*Math.abs(e.line))+"%";break;case"rl":switch(s+="transform: translateY(-50%);",e.lineAlign){case"start":s+="text-align: left;",n.push(i+"cue-align-top");break;case"middle":s+="text-align: center;",n.push(i+"cue-align-middle");break;case"end":s+="text-align: right;",n.push(i+"cue-align-bottom")}s+="height:"+e.size+";",s+="top:"+e.position+";",-1<String(e.line).indexOf("%")||0<=e.line?(e.line,s+="left:"+e.line+"%"):s+="right:"+(100-100*Math.abs(e.line))+"%";break;case"lr":switch(s+="transform: translateY(-50%);",e.lineAlign){case"start":s+="text-align: left;",n.push(i+"cue-align-top");break;case"middle":s+="text-align: center;",n.push(i+"cue-align-middle");break;case"end":s+="text-align: right;",n.push(i+"cue-align-bottom")}s+="height:"+e.size+";",s+="top:"+e.position+";",-1<String(e.line).indexOf("%")||0<=e.line?(e.line,s+="right:"+e.line+"%"):s+="left:"+(100-100*Math.abs(e.line))+"%"}return t.class=n.join(" "),t.style=s,t},destroy:function(){this.media=null}},{id:0}),Media.DOMEvents.add(["cueenter","cueexit"]),Media.Class.TextTrackList=Media.Class.List.extend({media$write:null,constructor:function(t){this.defineProperties({media$write:t}),this.fetch()},default$get:function(){return this.find(function(t){return t.default})},fetch$write:function(){this.destroy();var n={},t=this.media.el.querySelectorAll("track[type='text/vtt']");toArray(t).forEach(function(t){var e=t.getAttribute("srclang"),i=t.getAttribute("src");e&&i&&!n[e]&&(n[e]=new Media.Class.TextTrack(this.media,t))},this),this.addTracks(ObjectValues(n))},addTracks$write:function(t){for(var e=0,i=t.length;e<i;e++)this.addTrack(t[e])},addTrack:function(t){for(var e=0,i=this.length;e<i;e++)if(this[e]===t)return;this.push(t),this.trigger("add",t,this),this.media.dispatchEvent("addtexttrack",{track:t})},removeTrack:function(t){for(var e=!1,i=this.length-1;-1<i;i--)this[i]===t&&(this.splice(i,1),e=!0);e&&(this.trigger("remove",t,this),this.media.dispatchEvent("removetexttrack",{track:t}))},getTrackById:function(t){for(var e=0,i=this.length;e<i;e++)if(this[e].el.id===t)return this[e];return null},destroy:function(){for(var t=0,e=this.length;t<e;t++)this[t].destroy();this.length=0,this.stopListening()}}),Media.DOMEvents.add(["addtexttrack","removetexttrack"]),Media.Class.TextTracks=Media.Class.extend({constructor:function(t){this.listenTo(Media,{create:this.onCreate,timeupdate:this.onTimeUpdate,destroy:this.onDestroy})},onCreate:function(t){t.defineProperties({tracks$enum$write:new Media.Class.TextTrackList(t)})},onTimeUpdate:function(t,e){if(e.slow)for(var i=0,n=t.tracks.length;i<n;i++)t.tracks[i].update()},onDestroy:function(t){t.tracks&&(t.tracks.destroy(),delete t.tracks)}},null,{instanceEvents:!0}),Media.defineProperties({texttracks$write:new Media.Class.TextTracks}),Media.Class.TimeUpdate=Media.Class.extend({playing:null,interval:null,slowInterval:null,inRaf:!1,lastTickTime:null,slowLastTickTime:null,mediumLastTickTime:null,constructor:function(){this.playing=[],this.listenTo(Media,{play:this.onPlay,"pause finish destroyed":this.onPause}),this.onRaf=this.onRaf.bind(this)},onPlay:function(t){for(var e=0,i=this.playing.length;e<i;e++)if(this.playing[e]===t)return;this.playing.push(t),this.inRaf||(rafer.request(this.onRaf),this.inRaf=!0)},onRaf:function(){var t=Media.DefaultOptions.get("fpsfast");this.interval=1e3/t,this.mediumInterval=1e3/(Media.DefaultOptions.get("fpsmedium")||t/2),this.slowInterval=1e3/(Media.DefaultOptions.get("fpsslow")||t/3);var e=Date.now();if(e<this.lastTickTime+this.interval)return this.playing.length?rafer.request(this.onRaf):this.inRaf=!1;var i={fast:!0,medium:!1,slow:!1};e>=this.mediumLastTickTime+this.mediumInterval&&(this.mediumLastTickTime=e,i.medium=!0),e>=this.slowLastTickTime+this.slowInterval&&(this.slowLastTickTime=e,i.slow=!0),this.lastTickTime=e;for(var n=0,s=this.playing.length;n<s;n++)this.playing[n].dispatchEvent("timeupdate",i);return rafer.request(this.onRaf)},onPause:function(t){for(var e=this.playing.length-1;-1<e;e--)this.playing[e]===t&&this.playing.splice(e,1)}},null,{instanceEvents:!0}),Media.defineProperties({timeupdate$write:new Media.Class.TimeUpdate}),Media.DefaultOptions.add({fpsfast:60,fpsmedium:30,fpsslow:12}),Media.defineProperties({utils$write:{}}),Media.utils.Rafer=Rafer,Media.utils.rafer=rafer,Media.utils.Class=Class,Media.utils.List=List,Media.utils.Elements=Elements,Media.utils.elements=elements,Media.utils.Events=Events,Media.utils.EventsInitialize=EventsInitialize,Media.utils.EventsArgumentsNotation=EventsArgumentsNotation,Media.utils.EventRegister=EventRegister,Media.utils.EventsRegistry=EventsRegistry,Media.utils.properties=properties,Media.utils.toArray=toArray,Media.utils.isArray=isArray,Media.utils.isObject=isObject,Media.utils.extend=extend,Media.utils.extendNotEnumerable=extendNotEnumerable,Media.utils.deepDefaults=deepDefaults,Media.utils.defaults=defaults,Media.utils.indexOfRegex=indexOfRegex,Media.utils.lastIndexOfRegex=lastIndexOfRegex,Media.utils.includes=includes,Media.utils.replace=replace,Media.utils.parseUnit=parseUnit,Media.utils.delay=delay,Media.utils.debounce=debounce,Media.utils.bindAll=bindAll,Media.utils.toggleClass=toggleClass,Media.utils.removeAttribute=removeAttribute,Media.utils.removeElement=removeElement,Media.utils.toggleClass=toggleClass,Media.utils.prependElement=prependElement,Media.utils.createEvent=createEvent,MediaUI.defineProperties({Language$write:Class.extend({constructor:function(t){defaults(this,t),this.defineProperties({p:!1,v:null})},isLoaded$get$enum:function(){return this.m},hash$set$enum:function(t){this.g=t,this.m=!0,MediaUI.languages.trigger("language:"+this.langCode,this)},hash$get$enum:function(){return this.g}})}),MediaUI.defineProperties({Languages:List.extend({constructor:function(){this.load("en")},load$enum$write:function(t,e){var i=this.search(t);if(this.once("language:"+t,function(t){e&&e(t)}),!i)return i=this.add({langCode:t}),void getUrl("./lang/"+t+".json",function(t){i.hash=JSON.parse(t)}.bind(this),function(){throw"Could not find media player language `"+t+"`"}.bind(this));i.isLoaded&&MediaUI.languages.trigger("language:"+t,i)},add$enum$write:function(t,e){var i=new MediaUI.Language(t,e);return this.push(i),i},search$enum$write:function(t){for(var e,i=0,n=this.length;i<n;i++){var s=this[i];if(s.langCode!==t)return;e=s;break}return e||null}},null,{instanceEvents:!0})}),MediaUI.defineProperties({languages$enum$write:new MediaUI.Languages}),Media.DefaultOptions.add({uilang:"en"}),MediaUI.Controller.Captions=MediaUI.Controller.extend({ui:null,constructor:function(t){MediaUI.Controller.apply(this,arguments),this.ui=t},isActive$get$enum:function(){return Boolean(this.ui.media.tracks.default)}}),MediaUI.Controller.FullScreen=MediaUI.Controller.extend({ui:null,constructor:function(t){MediaUI.Controller.apply(this,arguments),this.ui=t},isActive$get$enum:function(){return this.ui.el===document.fullscreenElement||document.fullscreenElement===this.ui.source},type$get$enum:function(){return window.fullscreenPolyfill.useFullWindow?"fullwindow":"browser"}}),MediaUI.Input.Engage=MediaUI.Input.extend({ui:null,isEngaged:!1,engageHandle:null,constructor:function(t){MediaUI.Input.apply(this,arguments),bindAll(this,"onUIReady","onTap","onBeginInput","onEndInput","engage","disengage"),this.ui=t,this.setUpListeners()},setUpListeners:function(){this.listenTo(this.ui,{begininput:this.onBeginInput,tap:this.onTap,endinput:this.onEndInput,ready:this.onUIReady}),this.listenTo(this.ui.media,{play:this.startDisengage,"pause skip":this.engage})},onUIReady:function(){this.engage()},onBeginInput:function(t){this.ui.media.el.paused||(this.isInInput=!0,Media.device.wasTouchedRecently||(this.stopDisengage(),this.engage()))},onTap:function(t){this.ui.media.el.paused||this.checkForceEngage(t)||(this.isEngaged?this.disengage():this.engage())},onEndInput:function(t){this.ui.media.el.paused||Media.device.wasTouchedRecently||this.checkForceEngage(t)||this.startDisengage()},checkForceEngage:function(t){if("mouseout"===t.type)return!1;var e=elements(t.target),i=e.stack().filterByAttribute(this.ui.options.inputattribute,"engage");return!(!Boolean(i.length)||e.isHidden()||(this.stopDisengage(),0))},engage:function(){this.isEngaged||(this.isEngaged=!0,this.ui.trigger("engage"))},disengage:function(){this.isEngaged&&(this.isEngaged=!1,this.ui.trigger("disengage"))},startDisengage:function(){this.isEngaged&&(this.engageHandle&&this.stopDisengage(),this.engageHandle=setTimeout(this.disengage,this.ui.options.uiengagetimeout||2e3))},stopDisengage:function(){this.engageHandle&&(clearTimeout(this.engageHandle),this.engageHandle=null)},destroy:function(){MediaUI.Input.prototype.destroy.apply(this,arguments),this.ui=null}}),Media.DefaultOptions.add({uiengagetimeout:2e3}),MediaUI.Input.ScrubCurrentTime=MediaUI.Input.extend({ui:null,$els:null,wasPlaying:!1,isMouseDown:!1,inTouch:!1,constructor:function(t){MediaUI.Input.apply(this,arguments),this.ui=t,this.$els=this.ui.$all().filterByAttribute(this.ui.options.inputattribute,"scrubcurrenttime"),bindAll(this,["onMouseDown","onMouseMove","onMouseUp","onTouchStart","onTouchMove","onTouchEnd"]),this.addEventListeners()},addEventListeners:function(){this.$els.on({mousedown:this.onMouseDown,touchstart:this.onTouchStart},{passive:!1}),elements(document.body).on({mouseup:this.onMouseUp,mousemove:this.onMouseMove},{passive:!0}),elements(document.body).on({touchend:this.onTouchEnd,touchmove:this.onTouchMove},{passive:!1})},onMouseDown:function(t){if(1&t.buttons){t.stopPropagation(),this.wasPlaying=!this.ui.source.paused,this.isMouseDown=!0,this.ui.source.pause();var e=t.clientX;this.setTimeFromLeft(e)}},onMouseMove:function(t){if(this.isMouseDown)if(1&t.buttons){var e=t.clientX;this.setTimeFromLeft(e)}else this.onMouseUp()},onMouseUp:function(){this.isMouseDown=!1,this.wasPlaying&&(this.wasPlaying=!1,this.ui.source.play())},onTouchStart:function(t){this.wasPlaying=!this.ui.source.paused,this.inTouch=!0,this.ui.source.pause();var e=t.touches[0].clientX;this.setTimeFromLeft(e)},onTouchMove:function(t){if(this.inTouch){var e=t.touches[0].clientX;this.setTimeFromLeft(e)}},onTouchEnd:function(t){this.inTouch=!1,this.wasPlaying&&(t.stopPropagation(),this.wasPlaying=!1,this.ui.source.play())},setTimeFromLeft:function(t){var e=this.$els[0].getBoundingClientRect(),i=this.$els[0].clientWidth,n=clamp(0,t-e.left,i)/i,s=this.ui.source.duration*n;this.ui.source.duration&&(this.ui.source.currentTime=s,this.ui.media.dispatchEvent("timeupdate",{slow:!0}))},removeEventListeners:function(){this.$els.off({mousedown:this.onMouseDown,touchstart:this.onTouchStart}),elements(document.body).off({mouseup:this.onMouseUp,mousemove:this.onMouseMove,touchend:this.onTouchEnd,touchmove:this.onTouchMove},{passive:!0})},destroy:function(){MediaUI.Input.prototype.destroy.apply(this,arguments),this.removeEventListeners(),this.ui=null,this.$els=null}}),MediaUI.Input.Skip=MediaUI.Input.extend({floorPrecision:10,ui:null,interactions:null,lastEvent:0,skipped:0,constructor:function(t){MediaUI.Input.apply(this,arguments),t.options.canskip&&(bindAll(this,"onDoubleTap"),this.interactions=[],this.clear=debounce(this.clear.bind(this),500),this.ui=t,this.listenTo(this.ui,{tap:this.onSingleTap,dbltap:this.onDoubleTap}))},onSingleTap:function(t){Media.device.wasTouchedRecently&&(this.interactions.length=0)},onDoubleTap:function(t){if(Media.device.wasTouchedRecently){var e=(t.target.getAttribute(this.ui.options.inputattribute)||"").split(" ");if(includes(e,"skip")){t.preventDefault(),Date.now();var i=t.target.offsetParent,n=i.getBoundingClientRect(),s=("touchend"===t.type?t.changedTouches[0].clientX-n.left:t.offsetX)/i.clientWidth,r=s<.5?"left":.5<s?"right":"none";this.interactions.push({direction:r}),this.skip(),this.clear()}}},skip:function(){var t=this.getSkipAmount();if(t){var e=t-this.skipped,i=this.ui.source.currentTime,n=this.ui.source.duration;(e=clamp(-i,e,n-i))&&(this.ui.source.currentTime+=e,this.skipped+=e,this.ui.media.dispatchEvent("skip",{skipAmount:t}),this.ui.media.dispatchEvent("timeupdate",{fast:!0,medium:!0,slow:!0}))}},clear:function(){this.getSkipAmount()&&(this.interactions.length=0,this.skipped=0)},getSkipAmount:function(){var t=this.interactions.slice(0);if(void 0!==t){for(var e=this.ui.options.skipseconds||10,i=0,n=0,s=0,r=t.length;s<r;s++)switch(t[s].direction){case"left":n++;break;case"right":i++}if((i||n)&&i-n!=0)return(i<n?-(n-i):i-n)*e}}}),Media.DefaultOptions.add({canskip:!0,skipseconds:10}),Media.DOMEvents.add("skip"),MediaUI.Input.Taps=MediaUI.Input.extend({ui:null,$els:null,isMouseDown:!1,isTouchDown:!1,lastEnd:0,taps:0,tapHandle:null,constructor:function(t){MediaUI.Input.apply(this,arguments),bindAll(this,"onTouchStart","onTouchEnd","onMouseDown","onMouseMove","onMouseOut","onMouseUp","triggerSingleTap"),this.ui=t,this.$els=this.ui.$("*").filterByAttribute(this.ui.options.inputattribute,"taps"),this.setUpListeners()},setUpListeners:function(){this.listenTo(this.ui,{stoptap:this.stopSingleTap}),this.$els.on({touchstart:this.onTouchStart,mousedown:this.onMouseDown,mousemove:this.onMouseMove,mouseout:this.onMouseOut}),elements(document.body).on({mouseup:this.onMouseUp,touchend:this.onTouchEnd})},onTouchStart:function(t){this.isTouchDown=!0,this.ui.trigger("begininput",t)},onMouseDown:function(t){Media.device.wasTouchedRecently||this.isTouchDown||1&t.buttons&&(this.isMouseDown=!0,this.ui.trigger("begininput",t))},onMouseMove:function(t){Media.device.wasTouchedRecently||this.isMouseDown||this.isTouchDown||this.tapHandle||(this.ui.trigger("begininput",t),this.ui.trigger("endinput",t))},onMouseOut:function(t){Media.device.wasTouchedRecently||this.isMouseDown||this.isTouchDown||this.ui.trigger("endinput",t)},onMouseUp:function(t){Media.device.wasTouchedRecently||this.isMouseDown&&(this.isMouseDown=!1,this.ui.trigger("endinput",t),this.onEndInput(t))},onTouchEnd:function(t){this.isTouchDown&&(this.isTouchDown=!1,this.ui.trigger("endinput",t),this.onEndInput(t))},onEndInput:function(t){if(this.stopSingleTap(),!this.isNoTaps(t)){this.taps++;var e=Date.now();e-this.lastEnd<(this.ui.options.uitapinterval||500)?2<=this.taps&&(this.ui.trigger("dbltap",t),this.taps=0):(this.singleTapEvent=t,this.startSingleTap()),this.lastEnd=e}},startSingleTap:function(){this.tapHandle&&this.stopSingleTap(),this.tapHandle=setTimeout(this.triggerSingleTap,this.ui.options.uitapinterval||500)},stopSingleTap:function(){this.tapHandle&&(clearTimeout(this.tapHandle),this.tapHandle=null)},triggerSingleTap:function(){clearTimeout(this.tapHandle),this.tapHandle=null,0!==this.taps&&(this.taps=0,this.ui.trigger("tap",this.singleTapEvent))},isNoTaps:function(t){return elements(t.target).stack().filterByAttribute("stoptappropagation").length},destroy:function(){MediaUI.Input.prototype.destroy.apply(this,arguments),this.$els.off({touchstart:this.onTouchStart,mousedown:this.onMouseDown,mousemove:this.onMouseMove,mouseout:this.onMouseOut}),elements(document.body).off({mouseup:this.onMouseUp,touchend:this.onTouchEnd}),this.ui=null,this.$els=null}}),Media.DefaultOptions.add({uitapinterval:300}),MediaUI.Input.ToggleCaptions=MediaUI.Input.extend({ui:null,$els:null,constructor:function(t){MediaUI.Input.apply(this,arguments),bindAll(this,"onClick"),this.ui=t,this.$els=this.ui.$all().filterByAttribute(this.ui.options.inputattribute,"togglecaptions"),this.$els.on({click:this.onClick})},onClick:function(){this.ui.media.captions.isActive?this.ui.media.tracks.default.default=!1:this.ui.media.tracks.length&&(this.ui.media.tracks[0].default=!0)},destroy:function(){MediaUI.Input.prototype.destroy.apply(this,arguments),this.$els.off("click",this.onClick),this.ui=null}}),MediaUI.Input.ToggleFullScreen=MediaUI.Input.extend({ui:null,$els:null,constructor:function(t){MediaUI.Input.apply(this,arguments),bindAll(this,"onClick","onDoubleTap"),this.ui=t,this.$els=this.ui.$all().filterByAttribute(this.ui.options.inputattribute,"togglefullscreen"),this.$els.on({click:this.onClick}),this.listenTo(this.ui,{dbltap:this.onDoubleTap})},onClick:function(){var t=this.ui.options;if(this.ui.options.usefullwindow&&(window.fullscreenPolyfill.useFullWindow=!0),Media.device.isIOS&&t.iosnativefullscreen)return document.fullscreenElement?void document.exitFullscreen():void this.ui.source.requestFullscreen();document.fullscreenElement?document.exitFullscreen():this.ui.el.requestFullscreen()},onDoubleTap:function(){Media.device.wasTouchedRecently||this.onClick()},destroy:function(){MediaUI.Input.prototype.destroy.apply(this,arguments),this.$els.off("click",this.onClick),this.ui=null}}),Media.DefaultOptions.add({iosnativefullscreen:!0,usefullwindow:!1}),MediaUI.Input.ToggleMute=MediaUI.Input.extend({ui:null,$els:null,constructor:function(t){MediaUI.Input.apply(this,arguments),bindAll(this,"onClick"),this.ui=t,this.$els=this.ui.$all().filterByAttribute(this.ui.options.inputattribute,"togglemute"),this.$els.on({click:this.onClick})},onClick:function(){this.ui.source.muted=!this.ui.source.muted},destroy:function(){MediaUI.Input.prototype.destroy.apply(this,arguments),this.$els.off("click",this.onClick),this.ui=null}}),MediaUI.Input.TogglePlayPause=MediaUI.Input.extend({ui:null,$els:null,constructor:function(t){MediaUI.Input.apply(this,arguments),bindAll(this,"onClick","onTap"),this.$els=t.$all().filterByAttribute(t.options.inputattribute,"toggleplaypause"),this.$els.length&&(this.ui=t,this.$els.on({click:this.onClick}),this.listenTo(this.ui,{tap:this.onTap}))},onClick:function(t){t.stopPropagation(),elements(t.target).isHidden()||(this.ui.trigger("stoptap"),this.toggle())},onTap:function(t){var e=elements(t.target),i=e.filterByAttribute(this.ui.options.inputattribute,"toggleplaypause:notouch");e.isHidden()||!i.length||Media.device.wasTouchedRecently||this.toggle()},toggle:function(){this.ui.source.paused?this.ui.source.play():this.ui.source.pause()},destroy:function(){MediaUI.Input.prototype.destroy.apply(this,arguments),this.$els.off("click",this.onClick),this.ui=null}}),MediaUI.Output.BufferedWidth=MediaUI.Output.extend({floorPrecision:10,ui:null,$els:null,constructor:function(t){MediaUI.Output.apply(this,arguments),this.$els=t.$all().filterByAttribute(t.options.outputattribute,"bufferedwidth"),this.$els.length&&(this.ui=t,this.listenTo(this.ui.media,{"timeupdate postresize ended":this.onTimeUpdate,destroyed:this.destroy}),this.onTimeUpdate())},onTimeUpdate:function(t){t&&"timeupdate"===t.type&&!t.medium||this.update()},update:function(){if(this.$els.length){var t=this.ui.source.duration;!(u=this.ui.source.buffered).length&&this.ui.source.seekable.length&&(u=this.ui.source.seekable);for(var e=0,i=0,n=u.length;i<n;i++){var s=u.start(i);e+=u.end(i)-s}for(var r=e/t||0,a=0,o=this.$els.length;a<o;a++){var u,l=(u=this.$els[a]).offsetParent.clientWidth*r+"px";rafer.set(u.style,"width",l)}}},destroy:function(){MediaUI.Output.prototype.destroy.apply(this,arguments),this.ui=null,this.$els=null}}),MediaUI.Output.Captions=MediaUI.Output.extend({ui:null,$els:null,constructor:function(t){MediaUI.Output.apply(this,arguments),bindAll(this,"onTextTrackChange","onCueEnter","onCueExit"),this.ui=t,this.getElements(),this.setUpListeners()},getElements:function(){this.$els=this.ui.$("*:not(track)").filterByAttribute(this.ui.options.outputattribute,"captions")},setUpListeners:function(){this.listenTo(this.ui.media,{texttrackchange:this.onTextTrackChange,cueenter:this.onCueEnter,cueexit:this.onCueExit})},onTextTrackChange:function(t){this.$els.forEach(function(t){rafer.set(t,"innerHTML","")})},onCueEnter:function(e){this.$els.forEach(function(t){rafer.call(t,"appendChild",e.cue.getCueAsHTML())})},onCueExit:function(r){this.$els.forEach(function(t){for(var e=t.querySelectorAll("#"+r.cue.id),i=0,n=e.length;i<n;i++){var s=e[i];rafer.call(null,removeElement,s)}})},destroy:function(){MediaUI.Output.prototype.destroy.apply(this,arguments),this.ui=null,this.$els=null}}),MediaUI.Output.CaptionsAria=MediaUI.Output.extend({ui:null,$els:null,constructor:function(t){MediaUI.Output.apply(this,arguments),this.$els=t.$all().filterByAttribute(t.options.outputattribute,"captionsaria"),this.$els.length&&(this.ui=t,this.listenTo(this.ui.media,{texttrackchange:this.onUpdate}),this.onUpdate())},onUpdate:function(t){if(this.$els.length){var e=this.ui.options;MediaUI.languages.load(e.uilang||"en",function(t){var e;this.ui.captions.isActive,e=template("${options.Captions}",t.hash),rafer.call(this.$els,"attr","aria-label",e)}.bind(this))}},destroy:function(){MediaUI.Output.prototype.destroy.apply(this,arguments),this.ui=null,this.$els=null}}),MediaUI.Output.CurrentTimeWidth=MediaUI.Output.extend({ui:null,$els:null,constructor:function(t){MediaUI.Output.apply(this,arguments),this.$els=t.$all().filterByAttribute(t.options.outputattribute,"currenttimewidth"),this.$els.length&&(this.ui=t,this.listenTo(this.ui.media,{"timeupdate postresize ended":this.onTimeUpdate,destroyed:this.destroy}),this.onTimeUpdate())},onTimeUpdate:function(t){t&&"timeupdate"===t.type&&!t.medium||this.update()},update:function(){if(this.$els.length)for(var t=this.ui.source.currentTime/this.ui.source.duration||0,e=0,i=this.$els.length;e<i;e++){var n=this.$els[e],s=n.offsetParent.clientWidth*t+"px";rafer.set(n.style,"width",s)}},destroy:function(){MediaUI.Output.prototype.destroy.apply(this,arguments),this.ui=null,this.$els=null}}),MediaUI.Output.EngageState=MediaUI.Output.extend({ui:null,$els:null,constructor:function(t){MediaUI.Output.apply(this,arguments),bindAll(this,"onEngage","onDisengage"),this.$els=t.$all().filterByAttribute(t.options.outputattribute,"engagestate"),this.$els.length&&(this.ui=t,this.listenTo(this.ui,{engage:this.onEngage,disengage:this.onDisengage}))},onEngage:function(){rafer.call(this.$els,"toggleClass",template("${options.classprefix}engagestate-engaged",this.ui.options),!0),rafer.call(this.$els,"toggleClass",template("${options.classprefix}engagestate-disengaged",this.ui.options),!1)},onDisengage:function(){rafer.call(this.$els,"toggleClass",template("${options.classprefix}engagestate-disengaged",this.ui.options),!0),rafer.call(this.$els,"toggleClass",template("${options.classprefix}engagestate-engaged",this.ui.options),!1)},destroy:function(){MediaUI.Output.prototype.destroy.apply(this,arguments),this.ui=null,this.$els=null}}),MediaUI.Output.PlayPauseAria=MediaUI.Output.extend({ui:null,$els:null,constructor:function(t){MediaUI.Output.apply(this,arguments),this.$els=t.$all().filterByAttribute(t.options.outputattribute,"playpausearia"),this.$els.length&&(this.ui=t,this.listenTo(this.ui.media,{"play pause":this.onUpdate}),this.onUpdate())},onUpdate:function(t){if(this.$els.length){var e=this.ui.options;MediaUI.languages.load(e.uilang||"en",function(t){var e,i=this.ui.source.paused;e=template(i?"${options.Pause}":"${options.Play}",t.hash),rafer.call(this.$els,"attr","aria-label",e)}.bind(this))}},destroy:function(){MediaUI.Output.prototype.destroy.apply(this,arguments),this.ui=null,this.$els=null}}),MediaUI.Output.PlayPauseState=MediaUI.Output.extend({floorPrecision:10,ui:null,$els:null,constructor:function(t){MediaUI.Output.apply(this,arguments),this.$els=t.$all().filterByAttribute(t.options.outputattribute,"playpausestate"),this.$els.length&&(this.ui=t,this.listenTo(this.ui.media,{"timeupdate play pause ended":this.onTimeUpdate}),this.onTimeUpdate())},onTimeUpdate:function(t){if((!t||"timeupdate"!==t.type||t.slow)&&this.$els.length){var e=this.ui.options,i=this.isAtStart(),n=this.isAtEnd(),s=this.ui.source.paused;rafer.call(this.$els,"toggleClass",template("${options.classprefix}playpausestate-playing",e),!s),rafer.call(this.$els,"toggleClass",template("${options.classprefix}playpausestate-paused",e),s),rafer.call(this.$els,"toggleClass",template("${options.classprefix}playpausestate-start",e),i),rafer.call(this.$els,"toggleClass",template("${options.classprefix}playpausestate-end",e),n),rafer.call(this.$els,"toggleClass",template("${options.classprefix}playpausestate-middle",e),!n&&!i)}},isAtStart:function(){var t=this.ui.source.currentTime;return Math.floor(t*this.floorPrecision)<=1},isAtEnd:function(){var t=this.ui.source.currentTime,e=this.ui.source.duration;return Math.abs(Math.floor(t*this.floorPrecision)-Math.floor(e*this.floorPrecision))<=1},destroy:function(){MediaUI.Output.prototype.destroy.apply(this,arguments),this.ui=null,this.$els=null}}),MediaUI.Output.Resize=MediaUI.Output.extend({ui:null,el:null,constructor:function(t){MediaUI.Output.apply(this,arguments),bindAll(this,"onResize"),this.el=t.$all().filterByAttribute(t.options.outputattribute,"resize")[0],this.el&&(this.ui=t,this.listenTo(this.ui.media,{resize:this.onResize}))},onResize:function(t){var e=this.getUIDimensions(),i=this.ui.el.offsetParent||window,n=new Media.Class.Dimensions(i);this.applyStyles(this.el,n,e[this.ui.fullscreen.isActive?"fullscreen":"normal"]);var s=Boolean(find(elements(this.ui.source).stack(),function(t){return t===this.ui.el}))?this.ui.el.offsetParent:this.ui.source.offsetParent;n=new Media.Class.Dimensions(s||window),this.applyStyles(this.ui.source,n,t[this.ui.fullscreen.isActive?"fullscreen":"normal"])},applyStyles:function(t,e,i){switch(t.style["object-fit"]="fill",i.width.unit){case"contain":i.ratio<=e.ratio?(t.style.height=e.height.value+e.height.unit,t.style.width=e.height.value*i.ratio+e.height.unit):(t.style.width=e.width.value+e.width.unit,t.style.height=e.width.value/i.ratio+e.width.unit);break;case"cover":i.ratio<=e.ratio?(t.style.width=e.width.value+e.width.unit,t.style.height=e.width.value/i.ratio+e.width.unit):(t.style.height=e.height.value+e.height.unit,t.style.width=e.height.value*i.ratio+e.height.unit);break;case"retain":var n=clamp(0,e.height.value,t.videoHeight||t.originalHeight||t.height),s=clamp(0,e.width.value,t.videoWidth||t.originalWidth||t.width);i.ratio<=e.ratio?(t.style.height=n+e.height.unit,t.style.width=n*i.ratio+e.height.unit):(t.style.width=s+e.width.unit,t.style.height=s/i.ratio+e.width.unit);break;case"fill":t.style.height=e.height.value+e.height.unit,t.style.width=e.width.value+e.width.unit;break;case"none":t.style.height="",t.style.width="";break;default:"auto"!==i.width.unit&&(t.style.width=i.width.value+i.width.unit),"auto"!==i.height.unit&&(t.style.height=i.height.value+i.height.unit),"auto"===i.width.unit&&(t.style.width=e.height.value*i.ratio+"px"),"auto"===i.height.unit&&(t.style.height=e.width.value/i.ratio+"px")}var r=!1,a=!1,o=["0","0"],u=["","","",""];switch(i.x.keyword){case"center":a=r=!0,u[3]="50%",o[0]="-50%";break;case"left":r=!0,u[3]=i.x.value;break;case"right":r=!0,u[1]=i.x.value}switch(i.y.keyword){case"center":a=r=!0,u[0]="50%",o[1]="-50%";break;case"top":r=!0,u[0]=i.y.value;break;case"bottom":r=!0,u[2]=i.y.value}t.style.position=r?"absolute":"",t.style.transform=a?"translate("+o.join(",")+")":"",t.style.top=u[0],t.style.right=u[1],t.style.bottom=u[2],t.style.left=u[3]},getUIDimensions:function(){var t=this.ui.options;return{fullscreen:new Media.Class.Dimensions(t.uifullscreensize,t.uifullscreenratio,t.uifullscreenposition),normal:new Media.Class.Dimensions(t.uisize,t.uiratio,t.uiposition)}},destroy:function(){MediaUI.Output.prototype.destroy.apply(this,arguments),this.ui=null,this.el=null}}),Media.DefaultOptions.add({uisize:function(){return this.mediasize},uiratio:function(){return this.mediaratio},uiposition:"none none",uifullscreensize:function(){return this.uisize},uifullscreenratio:function(){return this.uiratio},uifullscreenposition:function(){return this.uiposition}}),MediaUI.Output.ResizeState=MediaUI.Output.extend({ui:null,el:null,constructor:function(t){MediaUI.Output.apply(this,arguments),bindAll(this,"onResize"),this.el=t.$all().filterByAttribute(t.options.outputattribute,"resizestate")[0],this.el&&(this.ui=t,this.listenTo(this.ui.media,{resize:this.onResize}))},onResize:function(t){toggleClass(this.el,this.ui.options.classprefix+"fullscreen-"+this.ui.fullscreen.type,this.ui.fullscreen.isActive)},destroy:function(){MediaUI.Output.prototype.destroy.apply(this,arguments),this.ui=null,this.el=null}}),MediaUI.Output.SkipState=MediaUI.Output.extend({ui:null,$els:null,constructor:function(t){MediaUI.Output.apply(this,arguments),this.ui=t,this.$els=this.ui.$("*").filterByAttribute(this.ui.options.outputattribute,"skipstate"),this.listenTo(this.ui.media,{skip:this.onSkip})},onSkip:function(t){this.$els.length&&t.skipAmount},destroy:function(){MediaUI.Output.prototype.destroy.apply(this,arguments),this.ui=null,this.$els=null}});})(window, window.jQuery);
